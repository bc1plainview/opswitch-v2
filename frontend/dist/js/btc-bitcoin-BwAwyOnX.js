const Ut={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bech32Opnet:"op",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},Yi={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bcrt",bech32Opnet:"opr",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},Wi={messagePrefix:`Bitcoin Signed Message:
`,bech32:"tb",bech32Opnet:"opt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},Zi={messagePrefix:`Dogecoin Signed Message:
`,bech32:"",bech32Opnet:"",bip32:{public:49990397,private:49988504},pubKeyHash:30,scriptHash:22,wif:158},Xi={messagePrefix:`Dogecoin Signed Message:
`,bech32:"",bech32Opnet:"",bip32:{public:70429096,private:70427203},pubKeyHash:113,scriptHash:196,wif:241},zi={messagePrefix:`Litecoin Signed Message:
`,bech32:"ltc",bech32Opnet:"opl",bip32:{public:27108450,private:27106558},pubKeyHash:48,scriptHash:50,wif:176},Qi={messagePrefix:`Litecoin Signed Message:
`,bech32:"tltc",bech32Opnet:"oplt",bip32:{public:70709117,private:70711009},pubKeyHash:111,scriptHash:58,wif:239},Ji={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bitcoincash",bech32Opnet:"opbch",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},ts={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bchtest",bech32Opnet:"opbcht",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},es={messagePrefix:`DarkCoin Signed Message:
`,bech32:"",bech32Opnet:"",bip32:{public:50221772,private:50221816},pubKeyHash:76,scriptHash:16,wif:204},rs={messagePrefix:`DarkCoin Signed Message:
`,bech32:"",bech32Opnet:"",bip32:{public:981492128,private:981489719},pubKeyHash:140,scriptHash:19,wif:239},Hf=Object.freeze(Object.defineProperty({__proto__:null,bitcoin:Ut,bitcoinCash:Ji,bitcoinCashTestnet:ts,dash:es,dashTestnet:rs,dogecoin:Zi,dogecoinTestnet:Xi,litecoin:zi,litecoinTestnet:Qi,regtest:Yi,testnet:Wi},Symbol.toStringTag,{value:"Module"}));var Gt={},Gr;function ns(){if(Gr)return Gt;Gr=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.bech32m=Gt.bech32=void 0;const e="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t={};for(let d=0;d<e.length;d++){const a=e.charAt(d);t[a]=d}function r(d){const a=d>>25;return(d&33554431)<<5^-(a>>0&1)&996825010^-(a>>1&1)&642813549^-(a>>2&1)&513874426^-(a>>3&1)&1027748829^-(a>>4&1)&705979059}function n(d){let a=1;for(let y=0;y<d.length;++y){const m=d.charCodeAt(y);if(m<33||m>126)return"Invalid prefix ("+d+")";a=r(a)^m>>5}a=r(a);for(let y=0;y<d.length;++y){const m=d.charCodeAt(y);a=r(a)^m&31}return a}function o(d,a,y,m){let b=0,v=0;const E=(1<<y)-1,T=[];for(let x=0;x<d.length;++x)for(b=b<<a|d[x],v+=a;v>=y;)v-=y,T.push(b>>v&E);if(m)v>0&&T.push(b<<y-v&E);else{if(v>=a)return"Excess padding";if(b<<y-v&E)return"Non-zero padding"}return T}function h(d){return o(d,8,5,!0)}function u(d){const a=o(d,5,8,!1);if(Array.isArray(a))return a}function c(d){const a=o(d,5,8,!1);if(Array.isArray(a))return a;throw new Error(a)}function p(d){let a;d==="bech32"?a=1:a=734539939;function y(E,T,x){if(x=x||90,E.length+7+T.length>x)throw new TypeError("Exceeds length limit");E=E.toLowerCase();let L=n(E);if(typeof L=="string")throw new Error(L);let D=E+"1";for(let V=0;V<T.length;++V){const K=T[V];if(K>>5!==0)throw new Error("Non 5-bit word");L=r(L)^K,D+=e.charAt(K)}for(let V=0;V<6;++V)L=r(L);L^=a;for(let V=0;V<6;++V){const K=L>>(5-V)*5&31;D+=e.charAt(K)}return D}function m(E,T){if(T=T||90,E.length<8)return E+" too short";if(E.length>T)return"Exceeds length limit";const x=E.toLowerCase(),L=E.toUpperCase();if(E!==x&&E!==L)return"Mixed-case string "+E;E=x;const D=E.lastIndexOf("1");if(D===-1)return"No separator character for "+E;if(D===0)return"Missing prefix for "+E;const V=E.slice(0,D),K=E.slice(D+1);if(K.length<6)return"Data too short";let J=n(V);if(typeof J=="string")return J;const Nt=[];for(let it=0;it<K.length;++it){const j=K.charAt(it),Et=t[j];if(Et===void 0)return"Unknown character "+j;J=r(J)^Et,!(it+6>=K.length)&&Nt.push(Et)}return J!==a?"Invalid checksum for "+E:{prefix:V,words:Nt}}function b(E,T){const x=m(E,T);if(typeof x=="object")return x}function v(E,T){const x=m(E,T);if(typeof x=="object")return x;throw new Error(x)}return{decodeUnsafe:b,decode:v,encode:y,toWords:h,fromWordsUnsafe:u,fromWords:c}}return Gt.bech32=p("bech32"),Gt.bech32m=p("bech32m"),Gt}var ut=ns();function kn(e){let t,r;try{t=ut.bech32.decode(e)}catch{}if(t){if(r=t.words[0],r!==0)throw new TypeError(e+" uses wrong encoding")}else if(t=ut.bech32m.decode(e),r=t.words[0],r===0)throw new TypeError(e+" uses wrong encoding");const n=ut.bech32.fromWords(t.words.slice(1));return{version:r,prefix:t.prefix,data:new Uint8Array(n)}}const xn="0123456789abcdefABCDEF";xn.split("").map(e=>e.codePointAt(0));Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),n=xn.indexOf(r);return n<0?void 0:n<16?n:n-6});new TextEncoder;new TextDecoder;function is(e,t,r,n){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>65535)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 65535. Received ${r}`);n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255):(e[t]=r>>8&255,e[t+1]=r&255)}function ss(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${r}`);n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255)}function os(e,t,r,n){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>0xffffffffffffffffn)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${0xffffffffffffffffn}. Received ${r}`);n==="LE"?(e[t]=Number(r&0xffn),e[t+1]=Number(r>>8n&0xffn),e[t+2]=Number(r>>16n&0xffn),e[t+3]=Number(r>>24n&0xffn),e[t+4]=Number(r>>32n&0xffn),e[t+5]=Number(r>>40n&0xffn),e[t+6]=Number(r>>48n&0xffn),e[t+7]=Number(r>>56n&0xffn)):(e[t]=Number(r>>56n&0xffn),e[t+1]=Number(r>>48n&0xffn),e[t+2]=Number(r>>40n&0xffn),e[t+3]=Number(r>>32n&0xffn),e[t+4]=Number(r>>24n&0xffn),e[t+5]=Number(r>>16n&0xffn),e[t+6]=Number(r>>8n&0xffn),e[t+7]=Number(r&0xffn))}function fs(e,t,r){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+1],n=(n<<8)+e[t],n}else{let n=0;return n=(n<<8)+e[t],n=(n<<8)+e[t+1],n}}function hs(e,t,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+3]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t]>>>0,n}else{let n=0;return n=(n<<8)+e[t]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+3]>>>0,n}}function us(e,t,r){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0n;return n=(n<<8n)+BigInt(e[t+7]),n=(n<<8n)+BigInt(e[t+6]),n=(n<<8n)+BigInt(e[t+5]),n=(n<<8n)+BigInt(e[t+4]),n=(n<<8n)+BigInt(e[t+3]),n=(n<<8n)+BigInt(e[t+2]),n=(n<<8n)+BigInt(e[t+1]),n=(n<<8n)+BigInt(e[t]),n}else{let n=0n;return n=(n<<8n)+BigInt(e[t]),n=(n<<8n)+BigInt(e[t+1]),n=(n<<8n)+BigInt(e[t+2]),n=(n<<8n)+BigInt(e[t+3]),n=(n<<8n)+BigInt(e[t+4]),n=(n<<8n)+BigInt(e[t+5]),n=(n<<8n)+BigInt(e[t+6]),n=(n<<8n)+BigInt(e[t+7]),n}}const as=e=>{if(e<0||e>0xffffffffffffffffn)throw new RangeError("value out of range")};function cs(e){if(e<0||e>Number.MAX_SAFE_INTEGER||e%1!==0)throw new RangeError("value out of range")}function _n(e){typeof e=="number"?cs(e):as(e)}function Sn(e,t,r){_n(e),r===void 0&&(r=0),t===void 0&&(t=new Uint8Array(Tr(e)));let n=0;return e<253?(t.set([Number(e)],r),n=1):e<=65535?(t.set([253],r),is(t,r+1,Number(e),"LE"),n=3):e<=4294967295?(t.set([254],r),ss(t,r+1,Number(e),"LE"),n=5):(t.set([255],r),os(t,r+1,BigInt(e),"LE"),n=9),{buffer:t,bytes:n}}function ls(e,t){t===void 0&&(t=0);const r=e.at(t);if(r===void 0)throw new Error("buffer too small");if(r<253)return{numberValue:r,bigintValue:BigInt(r),bytes:1};if(r===253){const n=fs(e,t+1,"LE");return{numberValue:n,bigintValue:BigInt(n),bytes:3}}else if(r===254){const n=hs(e,t+1,"LE");return{numberValue:n,bigintValue:BigInt(n),bytes:5}}else{const n=us(e,t+1,"LE");return{numberValue:n<=Number.MAX_SAFE_INTEGER?Number(n):null,bigintValue:n,bytes:9}}}function Tr(e){return _n(e),e<253?1:e<=65535?3:e<=4294967295?5:9}const ds=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),qr=(()=>{const e=new Array(128).fill(-1);for(let t=0;t<10;t++)e[48+t]=t;for(let t=0;t<6;t++)e[65+t]=10+t,e[97+t]=10+t;return e})();function ps(e){let t="";for(let r=0;r<e.length;r++){const n=ds[e[r]];t+=n}return t}function oe(e){e.length>=2&&e[0]==="0"&&(e[1]==="x"||e[1]==="X")&&(e=e.slice(2));const t=e.length;if(t%2!==0)throw new TypeError("Invalid hex string: odd length");const r=t/2,n=new Uint8Array(r);for(let o=0;o<r;o++){const h=o*2,u=e.charCodeAt(h),c=e.charCodeAt(h+1);if(u>=128||c>=128)throw new TypeError(`Invalid hex character at position ${h}`);const p=qr[u],d=qr[c];if(p===-1)throw new TypeError(`Invalid hex character at position ${h}`);if(d===-1)throw new TypeError(`Invalid hex character at position ${h+1}`);n[o]=p<<4|d}return n}function hr(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Nn(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(r=>typeof r=="string"):t.every(r=>Number.isSafeInteger(r)):!1}function ws(e){if(typeof e!="function")throw new Error("function expected");return!0}function ur(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Br(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function ar(e){if(!Array.isArray(e))throw new Error("array expected")}function Ln(e,t){if(!Nn(!0,t))throw new Error(`${e}: array of strings expected`)}function ys(e,t){if(!Nn(!1,t))throw new Error(`${e}: array of numbers expected`)}function Cn(...e){const t=h=>h,r=(h,u)=>c=>h(u(c)),n=e.map(h=>h.encode).reduceRight(r,t),o=e.map(h=>h.decode).reduce(r,t);return{encode:n,decode:o}}function gs(e){const t=e.split(""),r=t.length;Ln("alphabet",t);const n=new Map(t.map((o,h)=>[o,h]));return{encode:o=>(ar(o),o.map(h=>{if(!Number.isSafeInteger(h)||h<0||h>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${h}". Allowed: ${e}`);return t[h]})),decode:o=>(ar(o),o.map(h=>{ur("alphabet.decode",h);const u=n.get(h);if(u===void 0)throw new Error(`Unknown letter: "${h}". Allowed: ${e}`);return u}))}}function bs(e=""){return ur("join",e),{encode:t=>(Ln("join.decode",t),t.join(e)),decode:t=>(ur("join.decode",t),t.split(e))}}function Yr(e,t,r){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: invalid to=${r}, base cannot be less than 2`);if(ar(e),!e.length)return[];let n=0;const o=[],h=Array.from(e,c=>{if(Br(c),c<0||c>=t)throw new Error(`invalid integer: ${c}`);return c}),u=h.length;for(;;){let c=0,p=!0;for(let d=n;d<u;d++){const a=h[d],y=t*c,m=y+a;if(!Number.isSafeInteger(m)||y/t!==c||m-a!==y)throw new Error("convertRadix: carry overflow");const b=m/r;c=m%r;const v=Math.floor(b);if(h[d]=v,!Number.isSafeInteger(v)||v*r+c!==m)throw new Error("convertRadix: carry overflow");if(p)v?p=!1:n=d;else continue}if(o.push(c),p)break}for(let c=0;c<e.length-1&&e[c]===0;c++)o.push(0);return o.reverse()}function ms(e){Br(e);const t=2**8;return{encode:r=>{if(!hr(r))throw new Error("radix.encode input should be Uint8Array");return Yr(Array.from(r),t,e)},decode:r=>(ys("radix.decode",r),Uint8Array.from(Yr(r,e,t)))}}function Es(e,t){return Br(e),ws(t),{encode(r){if(!hr(r))throw new Error("checksum.encode: input should be Uint8Array");const n=t(r).slice(0,e),o=new Uint8Array(r.length+e);return o.set(r),o.set(n,r.length),o},decode(r){if(!hr(r))throw new Error("checksum.decode: input should be Uint8Array");const n=r.slice(0,-e),o=r.slice(-e),h=t(n).slice(0,e);for(let u=0;u<e;u++)if(h[u]!==o[u])throw new Error("Invalid checksum");return n}}}const vs=e=>Cn(ms(58),gs(e),bs("")),Os=vs("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),As=e=>Cn(Es(4,t=>e(e(t))),Os);function Ps(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Hn(e,t,r=""){const n=Ps(e),o=e?.length;if(!n||t!==void 0){const h=r&&`"${r}" `,u="",c=n?`length=${o}`:`type=${typeof e}`;throw new Error(h+"expected Uint8Array"+u+", got "+c)}return e}function Wr(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Is(e,t){Hn(e,void 0,"digestInto() output");const r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function be(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Je(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function It(e,t){return e<<32-t|e>>>t}function Oe(e,t){return e<<t|e>>>32-t>>>0}function Dn(e,t={}){const r=(o,h)=>e(h).update(o).digest(),n=e(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=o=>e(o),Object.assign(r,t),Object.freeze(r)}const Ts=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function Bs(e,t,r){return e&t^~e&r}function Us(e,t,r){return e&t^e&r^t&r}class Vn{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,n,o){this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=Je(this.buffer)}update(t){Wr(this),Hn(t);const{view:r,buffer:n,blockLen:o}=this,h=t.length;for(let u=0;u<h;){const c=Math.min(o-this.pos,h-u);if(c===o){const p=Je(t);for(;o<=h-u;u+=o)this.process(p,u);continue}n.set(t.subarray(u,u+c),this.pos),this.pos+=c,u+=c,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Wr(this),Is(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:h}=this;let{pos:u}=this;r[u++]=128,be(this.buffer.subarray(u)),this.padOffset>o-u&&(this.process(n,0),u=0);for(let y=u;y<o;y++)r[y]=0;n.setBigUint64(o-8,BigInt(this.length*8),h),this.process(n,0);const c=Je(t),p=this.outputLen;if(p%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const d=p/4,a=this.get();if(d>a.length)throw new Error("_sha2: outputLen bigger than state");for(let y=0;y<d;y++)c.setUint32(4*y,a[y],h)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:h,destroyed:u,pos:c}=this;return t.destroyed=u,t.finished=h,t.length=o,t.pos=c,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const Ct=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Rs=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ht=new Uint32Array(64);class ks extends Vn{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:r,C:n,D:o,E:h,F:u,G:c,H:p}=this;return[t,r,n,o,h,u,c,p]}set(t,r,n,o,h,u,c,p){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=h|0,this.F=u|0,this.G=c|0,this.H=p|0}process(t,r){for(let y=0;y<16;y++,r+=4)Ht[y]=t.getUint32(r,!1);for(let y=16;y<64;y++){const m=Ht[y-15],b=Ht[y-2],v=It(m,7)^It(m,18)^m>>>3,E=It(b,17)^It(b,19)^b>>>10;Ht[y]=E+Ht[y-7]+v+Ht[y-16]|0}let{A:n,B:o,C:h,D:u,E:c,F:p,G:d,H:a}=this;for(let y=0;y<64;y++){const m=It(c,6)^It(c,11)^It(c,25),b=a+m+Bs(c,p,d)+Rs[y]+Ht[y]|0,v=(It(n,2)^It(n,13)^It(n,22))+Us(n,o,h)|0;a=d,d=p,p=c,c=u+b|0,u=h,h=o,o=n,n=b+v|0}n=n+this.A|0,o=o+this.B|0,h=h+this.C|0,u=u+this.D|0,c=c+this.E|0,p=p+this.F|0,d=d+this.G|0,a=a+this.H|0,this.set(n,o,h,u,c,p,d,a)}roundClean(){be(Ht)}destroy(){this.set(0,0,0,0,0,0,0,0),be(this.buffer)}}class xs extends ks{A=Ct[0]|0;B=Ct[1]|0;C=Ct[2]|0;D=Ct[3]|0;E=Ct[4]|0;F=Ct[5]|0;G=Ct[6]|0;H=Ct[7]|0;constructor(){super(32)}}const Ur=Dn(()=>new xs,Ts(1)),Fn=As(Ur);function Mn(e){return Fn.encode(e)}function $n(e){return Fn.decode(e)}function jt(e){let t=0;for(const o of e)t+=o.length;const r=new Uint8Array(t);let n=0;for(const o of e)r.set(o,n),n+=o.length;return r}function $(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function me(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++){const o=e[n]-t[n];if(o!==0)return o}return e.length-t.length}function cr(e){for(let t=0;t<e.length;t++)if(e[t]!==0)return!1;return!0}function fe(e,t=0){const r=new Uint8Array(e);return t!==0&&r.fill(t),r}function _s(e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return!1;const t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return!1;const r=e[5+t];return!(r===0||6+t+r!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||r>1&&e[t+6]===0&&!(e[t+7]&128))}const Y={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP3:178,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};let Ae;function Ss(){if(!Ae){Ae={};for(const e of Object.keys(Y)){const t=Y[e];Ae[t]=e}}return Ae}Ss();function Kn(e){return e<Y.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}function Ns(e,t,r){const n=Kn(t),o=new DataView(e.buffer,e.byteOffset,e.byteLength);return n===1?e[r]=t:n===2?(e[r]=Y.OP_PUSHDATA1,e[r+1]=t):n===3?(e[r]=Y.OP_PUSHDATA2,o.setUint16(r+1,t,!0)):(e[r]=Y.OP_PUSHDATA4,o.setUint32(r+1,t,!0)),n}function Ls(e,t){const r=new DataView(e.buffer,e.byteOffset,e.byteLength),n=e[t];let o,h;if(n<Y.OP_PUSHDATA1)o=n,h=1;else if(n===Y.OP_PUSHDATA1){if(t+2>e.length)return null;o=e[t+1],h=2}else if(n===Y.OP_PUSHDATA2){if(t+3>e.length)return null;o=r.getUint16(t+1,!0),h=3}else{if(t+5>e.length)return null;if(n!==Y.OP_PUSHDATA4)throw new Error("Unexpected opcode");o=r.getUint32(t+1,!0),h=5}return{opcode:n,number:o,size:h}}var jn={},Ge={};Ge.byteLength=Ds;Ge.toByteArray=Fs;Ge.fromByteArray=Ks;var Bt=[],mt=[],Cs=typeof Uint8Array<"u"?Uint8Array:Array,tr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var te=0,Hs=tr.length;te<Hs;++te)Bt[te]=tr[te],mt[tr.charCodeAt(te)]=te;mt[45]=62;mt[95]=63;function Gn(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function Ds(e){var t=Gn(e),r=t[0],n=t[1];return(r+n)*3/4-n}function Vs(e,t,r){return(t+r)*3/4-r}function Fs(e){var t,r=Gn(e),n=r[0],o=r[1],h=new Cs(Vs(e,n,o)),u=0,c=o>0?n-4:n,p;for(p=0;p<c;p+=4)t=mt[e.charCodeAt(p)]<<18|mt[e.charCodeAt(p+1)]<<12|mt[e.charCodeAt(p+2)]<<6|mt[e.charCodeAt(p+3)],h[u++]=t>>16&255,h[u++]=t>>8&255,h[u++]=t&255;return o===2&&(t=mt[e.charCodeAt(p)]<<2|mt[e.charCodeAt(p+1)]>>4,h[u++]=t&255),o===1&&(t=mt[e.charCodeAt(p)]<<10|mt[e.charCodeAt(p+1)]<<4|mt[e.charCodeAt(p+2)]>>2,h[u++]=t>>8&255,h[u++]=t&255),h}function Ms(e){return Bt[e>>18&63]+Bt[e>>12&63]+Bt[e>>6&63]+Bt[e&63]}function $s(e,t,r){for(var n,o=[],h=t;h<r;h+=3)n=(e[h]<<16&16711680)+(e[h+1]<<8&65280)+(e[h+2]&255),o.push(Ms(n));return o.join("")}function Ks(e){for(var t,r=e.length,n=r%3,o=[],h=16383,u=0,c=r-n;u<c;u+=h)o.push($s(e,u,u+h>c?c:u+h));return n===1?(t=e[r-1],o.push(Bt[t>>2]+Bt[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],o.push(Bt[t>>10]+Bt[t>>4&63]+Bt[t<<2&63]+"=")),o.join("")}var Rr={};Rr.read=function(e,t,r,n,o){var h,u,c=o*8-n-1,p=(1<<c)-1,d=p>>1,a=-7,y=r?o-1:0,m=r?-1:1,b=e[t+y];for(y+=m,h=b&(1<<-a)-1,b>>=-a,a+=c;a>0;h=h*256+e[t+y],y+=m,a-=8);for(u=h&(1<<-a)-1,h>>=-a,a+=n;a>0;u=u*256+e[t+y],y+=m,a-=8);if(h===0)h=1-d;else{if(h===p)return u?NaN:(b?-1:1)*(1/0);u=u+Math.pow(2,n),h=h-d}return(b?-1:1)*u*Math.pow(2,h-n)};Rr.write=function(e,t,r,n,o,h){var u,c,p,d=h*8-o-1,a=(1<<d)-1,y=a>>1,m=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=n?0:h-1,v=n?1:-1,E=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,u=a):(u=Math.floor(Math.log(t)/Math.LN2),t*(p=Math.pow(2,-u))<1&&(u--,p*=2),u+y>=1?t+=m/p:t+=m*Math.pow(2,1-y),t*p>=2&&(u++,p/=2),u+y>=a?(c=0,u=a):u+y>=1?(c=(t*p-1)*Math.pow(2,o),u=u+y):(c=t*Math.pow(2,y-1)*Math.pow(2,o),u=0));o>=8;e[r+b]=c&255,b+=v,c/=256,o-=8);for(u=u<<o|c,d+=o;d>0;e[r+b]=u&255,b+=v,u/=256,d-=8);e[r+b-v]|=E*128};(function(e){const t=Ge,r=Rr,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=K,e.INSPECT_MAX_BYTES=50;const o=2147483647;e.kMaxLength=o;const{Uint8Array:h,ArrayBuffer:u,SharedArrayBuffer:c}=globalThis;a.TYPED_ARRAY_SUPPORT=p(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function p(){try{const i=new h(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,h.prototype),Object.setPrototypeOf(i,s),i.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function d(i){if(i>o)throw new RangeError('The value "'+i+'" is invalid for option "size"');const s=new h(i);return Object.setPrototypeOf(s,a.prototype),s}function a(i,s,f){if(typeof i=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(i)}return y(i,s,f)}a.poolSize=8192;function y(i,s,f){if(typeof i=="string")return E(i,s);if(u.isView(i))return x(i);if(i==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i);if(Pt(i,u)||i&&Pt(i.buffer,u)||typeof c<"u"&&(Pt(i,c)||i&&Pt(i.buffer,c)))return L(i,s,f);if(typeof i=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const l=i.valueOf&&i.valueOf();if(l!=null&&l!==i)return a.from(l,s,f);const w=D(i);if(w)return w;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof i[Symbol.toPrimitive]=="function")return a.from(i[Symbol.toPrimitive]("string"),s,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i)}a.from=function(i,s,f){return y(i,s,f)},Object.setPrototypeOf(a.prototype,h.prototype),Object.setPrototypeOf(a,h);function m(i){if(typeof i!="number")throw new TypeError('"size" argument must be of type number');if(i<0)throw new RangeError('The value "'+i+'" is invalid for option "size"')}function b(i,s,f){return m(i),i<=0?d(i):s!==void 0?typeof f=="string"?d(i).fill(s,f):d(i).fill(s):d(i)}a.alloc=function(i,s,f){return b(i,s,f)};function v(i){return m(i),d(i<0?0:V(i)|0)}a.allocUnsafe=function(i){return v(i)},a.allocUnsafeSlow=function(i){return v(i)};function E(i,s){if((typeof s!="string"||s==="")&&(s="utf8"),!a.isEncoding(s))throw new TypeError("Unknown encoding: "+s);const f=J(i,s)|0;let l=d(f);const w=l.write(i,s);return w!==f&&(l=l.slice(0,w)),l}function T(i){const s=i.length<0?0:V(i.length)|0,f=d(s);for(let l=0;l<s;l+=1)f[l]=i[l]&255;return f}function x(i){if(Pt(i,h)){const s=new h(i);return L(s.buffer,s.byteOffset,s.byteLength)}return T(i)}function L(i,s,f){if(s<0||i.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<s+(f||0))throw new RangeError('"length" is outside of buffer bounds');let l;return s===void 0&&f===void 0?l=new h(i):f===void 0?l=new h(i,s):l=new h(i,s,f),Object.setPrototypeOf(l,a.prototype),l}function D(i){if(a.isBuffer(i)){const s=V(i.length)|0,f=d(s);return f.length===0||i.copy(f,0,0,s),f}if(i.length!==void 0)return typeof i.length!="number"||Qe(i.length)?d(0):T(i);if(i.type==="Buffer"&&Array.isArray(i.data))return T(i.data)}function V(i){if(i>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return i|0}function K(i){return+i!=i&&(i=0),a.alloc(+i)}a.isBuffer=function(i){return i!=null&&i._isBuffer===!0&&i!==a.prototype},a.compare=function(i,s){if(Pt(i,h)&&(i=a.from(i,i.offset,i.byteLength)),Pt(s,h)&&(s=a.from(s,s.offset,s.byteLength)),!a.isBuffer(i)||!a.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(i===s)return 0;let f=i.length,l=s.length;for(let w=0,g=Math.min(f,l);w<g;++w)if(i[w]!==s[w]){f=i[w],l=s[w];break}return f<l?-1:l<f?1:0},a.isEncoding=function(i){switch(String(i).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(i,s){if(!Array.isArray(i))throw new TypeError('"list" argument must be an Array of Buffers');if(i.length===0)return a.alloc(0);let f;if(s===void 0)for(s=0,f=0;f<i.length;++f)s+=i[f].length;const l=a.allocUnsafe(s);let w=0;for(f=0;f<i.length;++f){let g=i[f];if(Pt(g,h))w+g.length>l.length?(a.isBuffer(g)||(g=a.from(g)),g.copy(l,w)):h.prototype.set.call(l,g,w);else if(a.isBuffer(g))g.copy(l,w);else throw new TypeError('"list" argument must be an Array of Buffers');w+=g.length}return l};function J(i,s){if(a.isBuffer(i))return i.length;if(u.isView(i)||Pt(i,u))return i.byteLength;if(typeof i!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof i);const f=i.length,l=arguments.length>2&&arguments[2]===!0;if(!l&&f===0)return 0;let w=!1;for(;;)switch(s){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return ze(i).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f*2;case"hex":return f>>>1;case"base64":return jr(i).length;default:if(w)return l?-1:ze(i).length;s=(""+s).toLowerCase(),w=!0}}a.byteLength=J;function Nt(i,s,f){let l=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0,s>>>=0,f<=s))return"";for(i||(i="utf8");;)switch(i){case"hex":return F(this,s,f);case"utf8":case"utf-8":return _(this,s,f);case"ascii":return k(this,s,f);case"latin1":case"binary":return H(this,s,f);case"base64":return B(this,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return et(this,s,f);default:if(l)throw new TypeError("Unknown encoding: "+i);i=(i+"").toLowerCase(),l=!0}}a.prototype._isBuffer=!0;function it(i,s,f){const l=i[s];i[s]=i[f],i[f]=l}a.prototype.swap16=function(){const i=this.length;if(i%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let s=0;s<i;s+=2)it(this,s,s+1);return this},a.prototype.swap32=function(){const i=this.length;if(i%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let s=0;s<i;s+=4)it(this,s,s+3),it(this,s+1,s+2);return this},a.prototype.swap64=function(){const i=this.length;if(i%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let s=0;s<i;s+=8)it(this,s,s+7),it(this,s+1,s+6),it(this,s+2,s+5),it(this,s+3,s+4);return this},a.prototype.toString=function(){const i=this.length;return i===0?"":arguments.length===0?_(this,0,i):Nt.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(i){if(!a.isBuffer(i))throw new TypeError("Argument must be a Buffer");return this===i?!0:a.compare(this,i)===0},a.prototype.inspect=function(){let i="";const s=e.INSPECT_MAX_BYTES;return i=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(i+=" ... "),"<Buffer "+i+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(i,s,f,l,w){if(Pt(i,h)&&(i=a.from(i,i.offset,i.byteLength)),!a.isBuffer(i))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof i);if(s===void 0&&(s=0),f===void 0&&(f=i?i.length:0),l===void 0&&(l=0),w===void 0&&(w=this.length),s<0||f>i.length||l<0||w>this.length)throw new RangeError("out of range index");if(l>=w&&s>=f)return 0;if(l>=w)return-1;if(s>=f)return 1;if(s>>>=0,f>>>=0,l>>>=0,w>>>=0,this===i)return 0;let g=w-l,P=f-s;const z=Math.min(g,P),ft=this.slice(l,w),Q=i.slice(s,f);for(let W=0;W<z;++W)if(ft[W]!==Q[W]){g=ft[W],P=Q[W];break}return g<P?-1:P<g?1:0};function j(i,s,f,l,w){if(i.length===0)return-1;if(typeof f=="string"?(l=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,Qe(f)&&(f=w?0:i.length-1),f<0&&(f=i.length+f),f>=i.length){if(w)return-1;f=i.length-1}else if(f<0)if(w)f=0;else return-1;if(typeof s=="string"&&(s=a.from(s,l)),a.isBuffer(s))return s.length===0?-1:Et(i,s,f,l,w);if(typeof s=="number")return s=s&255,typeof h.prototype.indexOf=="function"?w?h.prototype.indexOf.call(i,s,f):h.prototype.lastIndexOf.call(i,s,f):Et(i,[s],f,l,w);throw new TypeError("val must be string, number or Buffer")}function Et(i,s,f,l,w){let g=1,P=i.length,z=s.length;if(l!==void 0&&(l=String(l).toLowerCase(),l==="ucs2"||l==="ucs-2"||l==="utf16le"||l==="utf-16le")){if(i.length<2||s.length<2)return-1;g=2,P/=2,z/=2,f/=2}function ft(W,nt){return g===1?W[nt]:W.readUInt16BE(nt*g)}let Q;if(w){let W=-1;for(Q=f;Q<P;Q++)if(ft(i,Q)===ft(s,W===-1?0:Q-W)){if(W===-1&&(W=Q),Q-W+1===z)return W*g}else W!==-1&&(Q-=Q-W),W=-1}else for(f+z>P&&(f=P-z),Q=f;Q>=0;Q--){let W=!0;for(let nt=0;nt<z;nt++)if(ft(i,Q+nt)!==ft(s,nt)){W=!1;break}if(W)return Q}return-1}a.prototype.includes=function(i,s,f){return this.indexOf(i,s,f)!==-1},a.prototype.indexOf=function(i,s,f){return j(this,i,s,f,!0)},a.prototype.lastIndexOf=function(i,s,f){return j(this,i,s,f,!1)};function Rt(i,s,f,l){f=Number(f)||0;const w=i.length-f;l?(l=Number(l),l>w&&(l=w)):l=w;const g=s.length;l>g/2&&(l=g/2);let P;for(P=0;P<l;++P){const z=parseInt(s.substr(P*2,2),16);if(Qe(z))return P;i[f+P]=z}return P}function G(i,s,f,l){return ve(ze(s,i.length-f),i,f,l)}function I(i,s,f,l){return ve(Ki(s),i,f,l)}function A(i,s,f,l){return ve(jr(s),i,f,l)}function O(i,s,f,l){return ve(ji(s,i.length-f),i,f,l)}a.prototype.write=function(i,s,f,l){if(s===void 0)l="utf8",f=this.length,s=0;else if(f===void 0&&typeof s=="string")l=s,f=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(f)?(f=f>>>0,l===void 0&&(l="utf8")):(l=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const w=this.length-s;if((f===void 0||f>w)&&(f=w),i.length>0&&(f<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");l||(l="utf8");let g=!1;for(;;)switch(l){case"hex":return Rt(this,i,s,f);case"utf8":case"utf-8":return G(this,i,s,f);case"ascii":case"latin1":case"binary":return I(this,i,s,f);case"base64":return A(this,i,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,i,s,f);default:if(g)throw new TypeError("Unknown encoding: "+l);l=(""+l).toLowerCase(),g=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function B(i,s,f){return s===0&&f===i.length?t.fromByteArray(i):t.fromByteArray(i.slice(s,f))}function _(i,s,f){f=Math.min(i.length,f);const l=[];let w=s;for(;w<f;){const g=i[w];let P=null,z=g>239?4:g>223?3:g>191?2:1;if(w+z<=f){let ft,Q,W,nt;switch(z){case 1:g<128&&(P=g);break;case 2:ft=i[w+1],(ft&192)===128&&(nt=(g&31)<<6|ft&63,nt>127&&(P=nt));break;case 3:ft=i[w+1],Q=i[w+2],(ft&192)===128&&(Q&192)===128&&(nt=(g&15)<<12|(ft&63)<<6|Q&63,nt>2047&&(nt<55296||nt>57343)&&(P=nt));break;case 4:ft=i[w+1],Q=i[w+2],W=i[w+3],(ft&192)===128&&(Q&192)===128&&(W&192)===128&&(nt=(g&15)<<18|(ft&63)<<12|(Q&63)<<6|W&63,nt>65535&&nt<1114112&&(P=nt))}}P===null?(P=65533,z=1):P>65535&&(P-=65536,l.push(P>>>10&1023|55296),P=56320|P&1023),l.push(P),w+=z}return N(l)}const S=4096;function N(i){const s=i.length;if(s<=S)return String.fromCharCode.apply(String,i);let f="",l=0;for(;l<s;)f+=String.fromCharCode.apply(String,i.slice(l,l+=S));return f}function k(i,s,f){let l="";f=Math.min(i.length,f);for(let w=s;w<f;++w)l+=String.fromCharCode(i[w]&127);return l}function H(i,s,f){let l="";f=Math.min(i.length,f);for(let w=s;w<f;++w)l+=String.fromCharCode(i[w]);return l}function F(i,s,f){const l=i.length;(!s||s<0)&&(s=0),(!f||f<0||f>l)&&(f=l);let w="";for(let g=s;g<f;++g)w+=Gi[i[g]];return w}function et(i,s,f){const l=i.slice(s,f);let w="";for(let g=0;g<l.length-1;g+=2)w+=String.fromCharCode(l[g]+l[g+1]*256);return w}a.prototype.slice=function(i,s){const f=this.length;i=~~i,s=s===void 0?f:~~s,i<0?(i+=f,i<0&&(i=0)):i>f&&(i=f),s<0?(s+=f,s<0&&(s=0)):s>f&&(s=f),s<i&&(s=i);const l=this.subarray(i,s);return Object.setPrototypeOf(l,a.prototype),l};function M(i,s,f){if(i%1!==0||i<0)throw new RangeError("offset is not uint");if(i+s>f)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(i,s,f){i=i>>>0,s=s>>>0,f||M(i,s,this.length);let l=this[i],w=1,g=0;for(;++g<s&&(w*=256);)l+=this[i+g]*w;return l},a.prototype.readUintBE=a.prototype.readUIntBE=function(i,s,f){i=i>>>0,s=s>>>0,f||M(i,s,this.length);let l=this[i+--s],w=1;for(;s>0&&(w*=256);)l+=this[i+--s]*w;return l},a.prototype.readUint8=a.prototype.readUInt8=function(i,s){return i=i>>>0,s||M(i,1,this.length),this[i]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(i,s){return i=i>>>0,s||M(i,2,this.length),this[i]|this[i+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(i,s){return i=i>>>0,s||M(i,2,this.length),this[i]<<8|this[i+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(i,s){return i=i>>>0,s||M(i,4,this.length),(this[i]|this[i+1]<<8|this[i+2]<<16)+this[i+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(i,s){return i=i>>>0,s||M(i,4,this.length),this[i]*16777216+(this[i+1]<<16|this[i+2]<<8|this[i+3])},a.prototype.readBigUInt64LE=Lt(function(i){i=i>>>0,Jt(i,"offset");const s=this[i],f=this[i+7];(s===void 0||f===void 0)&&ue(i,this.length-8);const l=s+this[++i]*2**8+this[++i]*2**16+this[++i]*2**24,w=this[++i]+this[++i]*2**8+this[++i]*2**16+f*2**24;return BigInt(l)+(BigInt(w)<<BigInt(32))}),a.prototype.readBigUInt64BE=Lt(function(i){i=i>>>0,Jt(i,"offset");const s=this[i],f=this[i+7];(s===void 0||f===void 0)&&ue(i,this.length-8);const l=s*2**24+this[++i]*2**16+this[++i]*2**8+this[++i],w=this[++i]*2**24+this[++i]*2**16+this[++i]*2**8+f;return(BigInt(l)<<BigInt(32))+BigInt(w)}),a.prototype.readIntLE=function(i,s,f){i=i>>>0,s=s>>>0,f||M(i,s,this.length);let l=this[i],w=1,g=0;for(;++g<s&&(w*=256);)l+=this[i+g]*w;return w*=128,l>=w&&(l-=Math.pow(2,8*s)),l},a.prototype.readIntBE=function(i,s,f){i=i>>>0,s=s>>>0,f||M(i,s,this.length);let l=s,w=1,g=this[i+--l];for(;l>0&&(w*=256);)g+=this[i+--l]*w;return w*=128,g>=w&&(g-=Math.pow(2,8*s)),g},a.prototype.readInt8=function(i,s){return i=i>>>0,s||M(i,1,this.length),this[i]&128?(255-this[i]+1)*-1:this[i]},a.prototype.readInt16LE=function(i,s){i=i>>>0,s||M(i,2,this.length);const f=this[i]|this[i+1]<<8;return f&32768?f|4294901760:f},a.prototype.readInt16BE=function(i,s){i=i>>>0,s||M(i,2,this.length);const f=this[i+1]|this[i]<<8;return f&32768?f|4294901760:f},a.prototype.readInt32LE=function(i,s){return i=i>>>0,s||M(i,4,this.length),this[i]|this[i+1]<<8|this[i+2]<<16|this[i+3]<<24},a.prototype.readInt32BE=function(i,s){return i=i>>>0,s||M(i,4,this.length),this[i]<<24|this[i+1]<<16|this[i+2]<<8|this[i+3]},a.prototype.readBigInt64LE=Lt(function(i){i=i>>>0,Jt(i,"offset");const s=this[i],f=this[i+7];(s===void 0||f===void 0)&&ue(i,this.length-8);const l=this[i+4]+this[i+5]*2**8+this[i+6]*2**16+(f<<24);return(BigInt(l)<<BigInt(32))+BigInt(s+this[++i]*2**8+this[++i]*2**16+this[++i]*2**24)}),a.prototype.readBigInt64BE=Lt(function(i){i=i>>>0,Jt(i,"offset");const s=this[i],f=this[i+7];(s===void 0||f===void 0)&&ue(i,this.length-8);const l=(s<<24)+this[++i]*2**16+this[++i]*2**8+this[++i];return(BigInt(l)<<BigInt(32))+BigInt(this[++i]*2**24+this[++i]*2**16+this[++i]*2**8+f)}),a.prototype.readFloatLE=function(i,s){return i=i>>>0,s||M(i,4,this.length),r.read(this,i,!0,23,4)},a.prototype.readFloatBE=function(i,s){return i=i>>>0,s||M(i,4,this.length),r.read(this,i,!1,23,4)},a.prototype.readDoubleLE=function(i,s){return i=i>>>0,s||M(i,8,this.length),r.read(this,i,!0,52,8)},a.prototype.readDoubleBE=function(i,s){return i=i>>>0,s||M(i,8,this.length),r.read(this,i,!1,52,8)};function C(i,s,f,l,w,g){if(!a.isBuffer(i))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>w||s<g)throw new RangeError('"value" argument is out of bounds');if(f+l>i.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(i,s,f,l){if(i=+i,s=s>>>0,f=f>>>0,!l){const P=Math.pow(2,8*f)-1;C(this,i,s,f,P,0)}let w=1,g=0;for(this[s]=i&255;++g<f&&(w*=256);)this[s+g]=i/w&255;return s+f},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(i,s,f,l){if(i=+i,s=s>>>0,f=f>>>0,!l){const P=Math.pow(2,8*f)-1;C(this,i,s,f,P,0)}let w=f-1,g=1;for(this[s+w]=i&255;--w>=0&&(g*=256);)this[s+w]=i/g&255;return s+f},a.prototype.writeUint8=a.prototype.writeUInt8=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,1,255,0),this[s]=i&255,s+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,2,65535,0),this[s]=i&255,this[s+1]=i>>>8,s+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,2,65535,0),this[s]=i>>>8,this[s+1]=i&255,s+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,4,4294967295,0),this[s+3]=i>>>24,this[s+2]=i>>>16,this[s+1]=i>>>8,this[s]=i&255,s+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,4,4294967295,0),this[s]=i>>>24,this[s+1]=i>>>16,this[s+2]=i>>>8,this[s+3]=i&255,s+4};function Z(i,s,f,l,w){Kr(s,l,w,i,f,7);let g=Number(s&BigInt(4294967295));i[f++]=g,g=g>>8,i[f++]=g,g=g>>8,i[f++]=g,g=g>>8,i[f++]=g;let P=Number(s>>BigInt(32)&BigInt(4294967295));return i[f++]=P,P=P>>8,i[f++]=P,P=P>>8,i[f++]=P,P=P>>8,i[f++]=P,f}function rt(i,s,f,l,w){Kr(s,l,w,i,f,7);let g=Number(s&BigInt(4294967295));i[f+7]=g,g=g>>8,i[f+6]=g,g=g>>8,i[f+5]=g,g=g>>8,i[f+4]=g;let P=Number(s>>BigInt(32)&BigInt(4294967295));return i[f+3]=P,P=P>>8,i[f+2]=P,P=P>>8,i[f+1]=P,P=P>>8,i[f]=P,f+8}a.prototype.writeBigUInt64LE=Lt(function(i,s=0){return Z(this,i,s,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Lt(function(i,s=0){return rt(this,i,s,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(i,s,f,l){if(i=+i,s=s>>>0,!l){const z=Math.pow(2,8*f-1);C(this,i,s,f,z-1,-z)}let w=0,g=1,P=0;for(this[s]=i&255;++w<f&&(g*=256);)i<0&&P===0&&this[s+w-1]!==0&&(P=1),this[s+w]=(i/g>>0)-P&255;return s+f},a.prototype.writeIntBE=function(i,s,f,l){if(i=+i,s=s>>>0,!l){const z=Math.pow(2,8*f-1);C(this,i,s,f,z-1,-z)}let w=f-1,g=1,P=0;for(this[s+w]=i&255;--w>=0&&(g*=256);)i<0&&P===0&&this[s+w+1]!==0&&(P=1),this[s+w]=(i/g>>0)-P&255;return s+f},a.prototype.writeInt8=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,1,127,-128),i<0&&(i=255+i+1),this[s]=i&255,s+1},a.prototype.writeInt16LE=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,2,32767,-32768),this[s]=i&255,this[s+1]=i>>>8,s+2},a.prototype.writeInt16BE=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,2,32767,-32768),this[s]=i>>>8,this[s+1]=i&255,s+2},a.prototype.writeInt32LE=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,4,2147483647,-2147483648),this[s]=i&255,this[s+1]=i>>>8,this[s+2]=i>>>16,this[s+3]=i>>>24,s+4},a.prototype.writeInt32BE=function(i,s,f){return i=+i,s=s>>>0,f||C(this,i,s,4,2147483647,-2147483648),i<0&&(i=4294967295+i+1),this[s]=i>>>24,this[s+1]=i>>>16,this[s+2]=i>>>8,this[s+3]=i&255,s+4},a.prototype.writeBigInt64LE=Lt(function(i,s=0){return Z(this,i,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Lt(function(i,s=0){return rt(this,i,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function wt(i,s,f,l,w,g){if(f+l>i.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function X(i,s,f,l,w){return s=+s,f=f>>>0,w||wt(i,s,f,4),r.write(i,s,f,l,23,4),f+4}a.prototype.writeFloatLE=function(i,s,f){return X(this,i,s,!0,f)},a.prototype.writeFloatBE=function(i,s,f){return X(this,i,s,!1,f)};function st(i,s,f,l,w){return s=+s,f=f>>>0,w||wt(i,s,f,8),r.write(i,s,f,l,52,8),f+8}a.prototype.writeDoubleLE=function(i,s,f){return st(this,i,s,!0,f)},a.prototype.writeDoubleBE=function(i,s,f){return st(this,i,s,!1,f)},a.prototype.copy=function(i,s,f,l){if(!a.isBuffer(i))throw new TypeError("argument should be a Buffer");if(f||(f=0),!l&&l!==0&&(l=this.length),s>=i.length&&(s=i.length),s||(s=0),l>0&&l<f&&(l=f),l===f||i.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(l<0)throw new RangeError("sourceEnd out of bounds");l>this.length&&(l=this.length),i.length-s<l-f&&(l=i.length-s+f);const w=l-f;return this===i&&typeof h.prototype.copyWithin=="function"?this.copyWithin(s,f,l):h.prototype.set.call(i,this.subarray(f,l),s),w},a.prototype.fill=function(i,s,f,l){if(typeof i=="string"){if(typeof s=="string"?(l=s,s=0,f=this.length):typeof f=="string"&&(l=f,f=this.length),l!==void 0&&typeof l!="string")throw new TypeError("encoding must be a string");if(typeof l=="string"&&!a.isEncoding(l))throw new TypeError("Unknown encoding: "+l);if(i.length===1){const g=i.charCodeAt(0);(l==="utf8"&&g<128||l==="latin1")&&(i=g)}}else typeof i=="number"?i=i&255:typeof i=="boolean"&&(i=Number(i));if(s<0||this.length<s||this.length<f)throw new RangeError("Out of range index");if(f<=s)return this;s=s>>>0,f=f===void 0?this.length:f>>>0,i||(i=0);let w;if(typeof i=="number")for(w=s;w<f;++w)this[w]=i;else{const g=a.isBuffer(i)?i:a.from(i,l),P=g.length;if(P===0)throw new TypeError('The value "'+i+'" is invalid for argument "value"');for(w=0;w<f-s;++w)this[w+s]=g[w%P]}return this};const vt={};function Qt(i,s,f){vt[i]=class extends f{constructor(){super(),Object.defineProperty(this,"message",{value:s.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${i}]`,this.stack,delete this.name}get code(){return i}set code(l){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:l,writable:!0})}toString(){return`${this.name} [${i}]: ${this.message}`}}}Qt("ERR_BUFFER_OUT_OF_BOUNDS",function(i){return i?`${i} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Qt("ERR_INVALID_ARG_TYPE",function(i,s){return`The "${i}" argument must be of type number. Received type ${typeof s}`},TypeError),Qt("ERR_OUT_OF_RANGE",function(i,s,f){let l=`The value of "${i}" is out of range.`,w=f;return Number.isInteger(f)&&Math.abs(f)>2**32?w=he(String(f)):typeof f=="bigint"&&(w=String(f),(f>BigInt(2)**BigInt(32)||f<-(BigInt(2)**BigInt(32)))&&(w=he(w)),w+="n"),l+=` It must be ${s}. Received ${w}`,l},RangeError);function he(i){let s="",f=i.length;const l=i[0]==="-"?1:0;for(;f>=l+4;f-=3)s=`_${i.slice(f-3,f)}${s}`;return`${i.slice(0,f)}${s}`}function Fi(i,s,f){Jt(s,"offset"),(i[s]===void 0||i[s+f]===void 0)&&ue(s,i.length-(f+1))}function Kr(i,s,f,l,w,g){if(i>f||i<s){const P=typeof s=="bigint"?"n":"";let z;throw s===0||s===BigInt(0)?z=`>= 0${P} and < 2${P} ** ${(g+1)*8}${P}`:z=`>= -(2${P} ** ${(g+1)*8-1}${P}) and < 2 ** ${(g+1)*8-1}${P}`,new vt.ERR_OUT_OF_RANGE("value",z,i)}Fi(l,w,g)}function Jt(i,s){if(typeof i!="number")throw new vt.ERR_INVALID_ARG_TYPE(s,"number",i)}function ue(i,s,f){throw Math.floor(i)!==i?(Jt(i,f),new vt.ERR_OUT_OF_RANGE("offset","an integer",i)):s<0?new vt.ERR_BUFFER_OUT_OF_BOUNDS:new vt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${s}`,i)}const Mi=/[^+/0-9A-Za-z-_]/g;function $i(i){if(i=i.split("=")[0],i=i.trim().replace(Mi,""),i.length<2)return"";for(;i.length%4!==0;)i=i+"=";return i}function ze(i,s){s=s||1/0;let f;const l=i.length;let w=null;const g=[];for(let P=0;P<l;++P){if(f=i.charCodeAt(P),f>55295&&f<57344){if(!w){if(f>56319){(s-=3)>-1&&g.push(239,191,189);continue}else if(P+1===l){(s-=3)>-1&&g.push(239,191,189);continue}w=f;continue}if(f<56320){(s-=3)>-1&&g.push(239,191,189),w=f;continue}f=(w-55296<<10|f-56320)+65536}else w&&(s-=3)>-1&&g.push(239,191,189);if(w=null,f<128){if((s-=1)<0)break;g.push(f)}else if(f<2048){if((s-=2)<0)break;g.push(f>>6|192,f&63|128)}else if(f<65536){if((s-=3)<0)break;g.push(f>>12|224,f>>6&63|128,f&63|128)}else if(f<1114112){if((s-=4)<0)break;g.push(f>>18|240,f>>12&63|128,f>>6&63|128,f&63|128)}else throw new Error("Invalid code point")}return g}function Ki(i){const s=[];for(let f=0;f<i.length;++f)s.push(i.charCodeAt(f)&255);return s}function ji(i,s){let f,l,w;const g=[];for(let P=0;P<i.length&&!((s-=2)<0);++P)f=i.charCodeAt(P),l=f>>8,w=f%256,g.push(w),g.push(l);return g}function jr(i){return t.toByteArray($i(i))}function ve(i,s,f,l){let w;for(w=0;w<l&&!(w+f>=s.length||w>=i.length);++w)s[w+f]=i[w];return w}function Pt(i,s){return i instanceof s||i!=null&&i.constructor!=null&&i.constructor.name!=null&&i.constructor.name===s.name}function Qe(i){return i!==i}const Gi=(function(){const i="0123456789abcdef",s=new Array(256);for(let f=0;f<16;++f){const l=f*16;for(let w=0;w<16;++w)s[l+w]=i[f]+i[w]}return s})();function Lt(i){return typeof BigInt>"u"?qi:i}function qi(){throw new Error("BigInt not supported")}})(jn);const js=jn.Buffer;function Gs(e){return e>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0}function qs(e){let t=Math.abs(e);const r=Gs(t),n=js.allocUnsafe(r),o=e<0;for(let h=0;h<r;++h)n.writeUInt8(t&255,h),t>>=8;return n[r-1]&128?n.writeUInt8(o?128:0,r-1):o&&(n[r-1]=n[r-1]|128),n}const lr=oe("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f");oe("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141");const ke=254;function Ys(e){return typeof e=="number"&&Number.isFinite(e)}function kr(e){return Array.isArray(e)}function Ws(e){return!(e instanceof Uint8Array)||e.length!==32||cr(e)?!1:me(e,lr)<0}function ne(e){if(!(e instanceof Uint8Array)||e.length<33)return!1;const t=e[0],r=e.subarray(1,33);if(cr(r)||me(r,lr)>=0)return!1;if((t===2||t===3)&&e.length===33)return!0;if(e.length!==65)return!1;const n=e.subarray(33);return cr(n)||me(n,lr)>=0?!1:t===4||t===6||t===7}function Zs(e){if(!e||typeof e!="object")return!1;const t=e;return!(!("output"in t)||!(t.output instanceof Uint8Array)||t.version!==void 0&&(typeof t.version!="number"||(t.version&ke)!==t.version))}function ie(e,t){return e.length!==t.length?!1:e.every((r,n)=>$(r,t[n]))}function Xs(e){return e instanceof Uint8Array&&e.length===32}function zs(e){if(!Xs(e))throw new TypeError(`Expected 32-byte Uint8Array, got ${e.length} bytes`);return e}function Qs(e){const t=e&-129;return t>0&&t<4}const qn=Y.OP_RESERVED;function Js(e){return Ys(e)&&(e===Y.OP_0||e>=Y.OP_1&&e<=Y.OP_16||e===Y.OP_1NEGATE)}function Yn(e){return e instanceof Uint8Array?!0:Js(e)}function xr(e){return kr(e)&&e.every(Yn)}function Wn(e){return e.length-e.filter(Yn).length}function dr(e){if(e.length===0)return Y.OP_0;if(e.length!==1)return;const t=e[0];if(t>=1&&t<=16)return qn+t;if(t===129)return Y.OP_1NEGATE}function Zn(e){return e instanceof Uint8Array}function to(e){return kr(e)}function pr(e){return e instanceof Uint8Array}function dt(e){if(Zn(e))return e;if(!kr(e))throw new TypeError("Expected an array");const t=e.reduce((o,h)=>pr(h)?h.length===1&&dr(h)!==void 0?o+1:o+Kn(h.length)+h.length:o+1,0),r=new Uint8Array(t);let n=0;if(e.forEach(o=>{if(pr(o)){const h=dr(o);if(h!==void 0){r[n]=h,n+=1;return}n+=Ns(r,o.length,n),r.set(o,n),n+=o.length}else r[n]=o,n+=1}),n!==r.length)throw new Error("Could not decode chunks");return r}function ht(e){if(to(e))return e;if(!(e instanceof Uint8Array))throw new TypeError("Expected a Uint8Array");const t=[];let r=0;for(;r<e.length;){const n=e[r];if(n>Y.OP_0&&n<=Y.OP_PUSHDATA4){const o=Ls(e,r);if(o===null||(r+=o.size,r+o.number>e.length))return null;const h=e.subarray(r,r+o.number);r+=o.number;const u=dr(h);u!==void 0?t.push(u):t.push(h)}else t.push(n),r+=1}return t}function eo(e){const t=Zn(e)?ht(e):e;if(!t||!xr(t))throw new TypeError("Expected push-only script");return t.map(r=>pr(r)?r:r===Y.OP_0?fe(0):qs(r-qn))}function qe(e){return!(e instanceof Uint8Array)||!Qs(e[e.length-1])?!1:_s(e.subarray(0,-1))}const ot={P2PK:"p2pk",P2PKH:"p2pkh",P2SH:"p2sh",P2MS:"p2ms",P2WPKH:"p2wpkh",P2WSH:"p2wsh",P2TR:"p2tr",P2OP:"p2op",Embed:"embed"},Zr=Y,Xr=16,zr=2,Qr=40;class ce{static NAME=ot.P2OP;#o;#a;#n;#i;#t;#e;#r;#s;#h;#u;#f;#c;#w=!1;#y=!1;#g=!1;#l=!1;#d=!1;#p;#m=!1;constructor(t,r){this.#o=t.network??Ut,this.#a={validate:r?.validate??!0,allowIncomplete:r?.allowIncomplete??!1},this.#n=t.address,this.#i=t.program,this.#t=t.deploymentVersion,this.#e=t.hash160,this.#r=t.output,this.#a.validate&&this.#T()}get name(){return ot.P2OP}get network(){return this.#o}get address(){return this.#w||(this.#s=this.#O(),this.#w=!0),this.#s}get program(){return this.#y||(this.#h=this.#b(),this.#y=!0),this.#h}get deploymentVersion(){return this.#g||(this.#u=this.#P(),this.#g=!0),this.#u}get hash160(){return this.#l||(this.#f=this.#A(),this.#l=!0),this.#f}get output(){return this.#d||(this.#c=this.#I(),this.#d=!0),this.#c}static fromProgram(t,r){return new ce({program:t,network:r})}static fromParts(t,r,n){return new ce({deploymentVersion:t,hash160:r,network:n})}static fromAddress(t,r){return new ce({address:t,network:r})}static fromOutput(t,r){return new ce({output:t,network:r})}toPayment(){return{name:this.name,network:this.network,address:this.address,program:this.program,deploymentVersion:this.deploymentVersion,hash160:this.hash160,output:this.output}}#E(){if(!this.#m){if(this.#n){const t=kn(this.#n);t&&(this.#p={version:t.version,prefix:t.prefix,data:t.data})}this.#m=!0}return this.#p}#v(){if(typeof this.#t<"u"&&typeof this.#e<"u"){if(this.#e.length!==20)throw new TypeError("hash160 must be exactly 20 bytes");if(this.#t<0||this.#t>255)throw new TypeError("deploymentVersion must fit in one byte");return jt([new Uint8Array([this.#t]),this.#e])}}#O(){if(this.#n)return this.#n;const t=this.program;if(!t)return;if(!this.#o.bech32Opnet)throw new TypeError("Network does not support opnet");const r=ut.bech32m.toWords(t);return r.unshift(Xr),ut.bech32m.encode(this.#o.bech32Opnet,r)}#b(){if(this.#i)return this.#i;const t=this.#v();if(t)return t;if(this.#r){if(this.#r[0]!==Zr.OP_16)throw new TypeError("Invalid P2OP script");let r=1,n;const o=this.#r[1],h=this.#r[2];if(o!==void 0&&o<76)n=o,r=2;else if(o===76&&h!==void 0)n=h,r=3;else throw new TypeError("Unsupported push opcode in P2OP script");return this.#r.subarray(r,r+n)}if(this.#n)return this.#E()?.data}#P(){if(this.#t!==void 0)return this.#t;const t=this.program;if(t)return t[0]}#A(){if(this.#e)return this.#e;const t=this.program;if(t)return t.subarray(1)}#I(){if(this.#r)return this.#r;const t=this.program;if(t)return dt([Zr.OP_16,t])}#T(){let t=fe(0);if(this.#n){const r=this.#E();if(!r)throw new TypeError("Invalid address");if(this.#o.bech32Opnet!==r.prefix)throw new TypeError("Invalid prefix or network mismatch");if(r.version!==Xr)throw new TypeError("Invalid witness version for p2op");if(r.data.length<zr||r.data.length>Qr)throw new TypeError("Invalid witness program length");t=r.data}if(this.#i){if(t.length>0&&!$(t,this.#i))throw new TypeError("Program mismatch");t=this.#i}if(!t.length&&this.#t!==void 0&&this.#e){const r=this.#v();r&&(t=r)}if(this.#r){const r=this.program;if(!r)throw new TypeError("Output program is required");if(t.length>0&&!$(t,r))throw new TypeError("Program mismatch (output vs other source)");t=r}if(t.length<zr||t.length>Qr)throw new TypeError(`Witness program must be 240 bytes. Was ${t.length} bytes`);if(this.#t!==void 0&&this.#t!==t[0])throw new TypeError("deploymentVersion mismatch");if(this.#e&&!$(this.#e,t.subarray(1)))throw new TypeError("hash160 mismatch")}}const ro=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Xn=Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)),no=Xn.map(e=>(9*e+5)%16),zn=(()=>{const e=[[Xn],[no]];for(let t=0;t<4;t++)for(let r of e)r.push(r[t].map(n=>ro[n]));return e})(),Qn=zn[0],Jn=zn[1],ti=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),io=Qn.map((e,t)=>e.map(r=>ti[t][r])),so=Jn.map((e,t)=>e.map(r=>ti[t][r])),oo=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),fo=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function Jr(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}const Pe=new Uint32Array(16);class ho extends Vn{h0=1732584193;h1=-271733879;h2=-1732584194;h3=271733878;h4=-1009589776;constructor(){super(64,20,8,!0)}get(){const{h0:t,h1:r,h2:n,h3:o,h4:h}=this;return[t,r,n,o,h]}set(t,r,n,o,h){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=o|0,this.h4=h|0}process(t,r){for(let b=0;b<16;b++,r+=4)Pe[b]=t.getUint32(r,!0);let n=this.h0|0,o=n,h=this.h1|0,u=h,c=this.h2|0,p=c,d=this.h3|0,a=d,y=this.h4|0,m=y;for(let b=0;b<5;b++){const v=4-b,E=oo[b],T=fo[b],x=Qn[b],L=Jn[b],D=io[b],V=so[b];for(let K=0;K<16;K++){const J=Oe(n+Jr(b,h,c,d)+Pe[x[K]]+E,D[K])+y|0;n=y,y=d,d=Oe(c,10)|0,c=h,h=J}for(let K=0;K<16;K++){const J=Oe(o+Jr(v,u,p,a)+Pe[L[K]]+T,V[K])+m|0;o=m,m=a,a=Oe(p,10)|0,p=u,u=J}}this.set(this.h1+c+a|0,this.h2+d+m|0,this.h3+y+o|0,this.h4+n+u|0,this.h0+h+p|0)}roundClean(){be(Pe)}destroy(){this.destroyed=!0,be(this.buffer),this.set(0,0,0,0,0)}}const uo=Dn(()=>new ho);function wr(e){return Ur(e)}function At(e){return uo(Ur(e))}const ao={"BIP0340/challenge":new Uint8Array([123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124,123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124]),"BIP0340/aux":new Uint8Array([241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144,241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144]),"BIP0340/nonce":new Uint8Array([7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47,7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47]),TapLeaf:new Uint8Array([174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238,174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238]),TapBranch:new Uint8Array([25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21,25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21]),TapSighash:new Uint8Array([244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49,244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49]),TapTweak:new Uint8Array([232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233,232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233]),"KeyAgg list":new Uint8Array([72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240,72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240]),"KeyAgg coefficient":new Uint8Array([191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129,191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129])};function _r(e,t){return wr(jt([ao[e],t]))}const ei={p:0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn,n:0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141n,h:1n,a:0n,b:7n,Gx:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Gy:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n},{p:Zt,n:co,Gx:lo,Gy:po,b:ri}=ei,yr=32,Sr=64,wo={publicKey:yr+1,publicKeyUncompressed:Sr+1},yo=(...e)=>{"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(...e)},pt=(e="")=>{const t=new Error(e);throw yo(t,pt),t},go=e=>typeof e=="bigint",bo=e=>typeof e=="string",mo=e=>e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array",Nr=(e,t,r="")=>{const n=mo(e),o=e?.length;if(!n||t!==void 0){const u=r&&`"${r}" `,c="",p=n?`length=${o}`:`type=${typeof e}`;pt(u+"expected Uint8Array"+c+", got "+p)}return e},ni=e=>new Uint8Array(e),ii=(e,t)=>e.toString(16).padStart(t,"0"),si=e=>Array.from(Nr(e)).map(t=>ii(t,2)).join(""),kt={_0:48,_9:57,A:65,F:70,a:97,f:102},tn=e=>{if(e>=kt._0&&e<=kt._9)return e-kt._0;if(e>=kt.A&&e<=kt.F)return e-(kt.A-10);if(e>=kt.a&&e<=kt.f)return e-(kt.a-10)},oi=e=>{const t="hex invalid";if(!bo(e))return pt(t);const r=e.length,n=r/2;if(r%2)return pt(t);const o=ni(n);for(let h=0,u=0;h<n;h++,u+=2){const c=tn(e.charCodeAt(u)),p=tn(e.charCodeAt(u+1));if(c===void 0||p===void 0)return pt(t);o[h]=c*16+p}return o},en=(...e)=>{const t=ni(e.reduce((n,o)=>n+Nr(o).length,0));let r=0;return e.forEach(n=>{t.set(n,r),r+=n.length}),t},Le=BigInt,Ye=(e,t,r,n="bad number: out of range")=>go(e)&&t<=e&&e<r?e:pt(n),U=(e,t=Zt)=>{const r=e%t;return r>=0n?r:t+r},Eo=(e,t)=>{(e===0n||t<=0n)&&pt("no inverse n="+e+" mod="+t);let r=U(e,t),n=t,o=0n,h=1n;for(;r!==0n;){const u=n/r,c=n%r,p=o-h*u;n=r,r=c,o=h,h=p}return n===1n?U(o,t):pt("no inverse")},er=e=>e instanceof yt?e:pt("Point expected"),fi=e=>U(U(e*e)*e+ri),rn=e=>Ye(e,0n,Zt),xe=e=>Ye(e,1n,Zt),vo=e=>Ye(e,1n,co),gr=e=>(e&1n)===0n,hi=e=>Uint8Array.of(e),Oo=e=>hi(gr(e)?2:3),Ao=e=>{const t=fi(xe(e));let r=1n;for(let n=t,o=(Zt+1n)/4n;o>0n;o>>=1n)o&1n&&(r=r*n%Zt),n=n*n%Zt;return U(r*r)===t?r:pt("sqrt invalid")};class yt{static BASE;static ZERO;X;Y;Z;constructor(t,r,n){this.X=rn(t),this.Y=xe(r),this.Z=rn(n),Object.freeze(this)}static CURVE(){return ei}static fromAffine(t){const{x:r,y:n}=t;return r===0n&&n===0n?qt:new yt(r,n,1n)}static fromBytes(t){Nr(t);const{publicKey:r,publicKeyUncompressed:n}=wo;let o;const h=t.length,u=t[0],c=t.subarray(1),p=nn(c,0,yr);if(h===r&&(u===2||u===3)){let d=Ao(p);const a=gr(d);gr(Le(u))!==a&&(d=U(-d)),o=new yt(p,d,1n)}return h===n&&u===4&&(o=new yt(p,nn(c,yr,Sr),1n)),o?o.assertValidity():pt("bad point: not on curve")}static fromHex(t){return yt.fromBytes(oi(t))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}equals(t){const{X:r,Y:n,Z:o}=this,{X:h,Y:u,Z:c}=er(t),p=U(r*c),d=U(h*o),a=U(n*c),y=U(u*o);return p===d&&a===y}is0(){return this.equals(qt)}negate(){return new yt(this.X,U(-this.Y),this.Z)}double(){return this.add(this)}add(t){const{X:r,Y:n,Z:o}=this,{X:h,Y:u,Z:c}=er(t),p=0n,d=ri;let a=0n,y=0n,m=0n;const b=U(d*3n);let v=U(r*h),E=U(n*u),T=U(o*c),x=U(r+n),L=U(h+u);x=U(x*L),L=U(v+E),x=U(x-L),L=U(r+o);let D=U(h+c);return L=U(L*D),D=U(v+T),L=U(L-D),D=U(n+o),a=U(u+c),D=U(D*a),a=U(E+T),D=U(D-a),m=U(p*L),a=U(b*T),m=U(a+m),a=U(E-m),m=U(E+m),y=U(a*m),E=U(v+v),E=U(E+v),T=U(p*T),L=U(b*L),E=U(E+T),T=U(v-T),T=U(p*T),L=U(L+T),v=U(E*L),y=U(y+v),v=U(D*L),a=U(x*a),a=U(a-v),v=U(x*E),m=U(D*m),m=U(m+v),new yt(a,y,m)}subtract(t){return this.add(er(t).negate())}multiply(t,r=!0){if(!r&&t===0n)return qt;if(vo(t),t===1n)return this;if(this.equals(Ee))return Uo(t).p;let n=qt,o=Ee;for(let h=this;t>0n;h=h.double(),t>>=1n)t&1n?n=n.add(h):r&&(o=o.add(h));return n}multiplyUnsafe(t){return this.multiply(t,!1)}toAffine(){const{X:t,Y:r,Z:n}=this;if(this.equals(qt))return{x:0n,y:0n};if(n===1n)return{x:t,y:r};const o=Eo(n,Zt);return U(n*o)!==1n&&pt("inverse invalid"),{x:U(t*o),y:U(r*o)}}assertValidity(){const{x:t,y:r}=this.toAffine();return xe(t),xe(r),U(r*r)===fi(t)?this:pt("bad point: not on curve")}toBytes(t=!0){const{x:r,y:n}=this.assertValidity().toAffine(),o=sn(r);return t?en(Oo(n),o):en(hi(4),o,sn(n))}toHex(t){return si(this.toBytes(t))}}const Ee=new yt(lo,po,1n),qt=new yt(0n,1n,0n);yt.BASE=Ee;yt.ZERO=qt;const Po=e=>Le("0x"+(si(e)||"0")),nn=(e,t,r)=>Po(e.subarray(t,r)),Io=2n**256n,sn=e=>oi(ii(Ye(e,0n,Io),Sr)),Ce=8,To=256,ui=Math.ceil(To/Ce)+1,br=2**(Ce-1),Bo=()=>{const e=[];let t=Ee,r=t;for(let n=0;n<ui;n++){r=t,e.push(r);for(let o=1;o<br;o++)r=r.add(t),e.push(r);t=r.double()}return e};let on;const fn=(e,t)=>{const r=t.negate();return e?r:t},Uo=e=>{const t=on||(on=Bo());let r=qt,n=Ee;const o=2**Ce,h=o,u=Le(o-1),c=Le(Ce);for(let p=0;p<ui;p++){let d=Number(e&u);e>>=c,d>br&&(d-=h,e+=1n);const a=p*br,y=a,m=a+Math.abs(d)-1,b=p%2!==0,v=d<0;d===0?n=n.add(fn(b,t[y])):r=r.add(fn(v,t[m]))}return e!==0n&&pt("invalid wnaf"),{p:r,f:n}};function hn(e){let t=e.toString(16);return t=t.padStart(64,"0"),t.length>64&&(t=t.slice(-64)),oe(t)}function un(e){if(e.length===32)return;if(![33,65].includes(e.length)){console.warn(`Unsupported key length=${e.length}. Must be 33 (compressed) or 65 (uncompressed).`);return}let t;try{t=yt.fromHex(ps(e))}catch{throw new Error("Invalid secp256k1 public key bytes. Cannot parse.")}const r=hn(t.x),n=hn(t.y),o=t.y%2n===0n?6:7,h=fe(65);h[0]=o,h.set(r,1),h.set(n,33);const u=jt([new Uint8Array([4]),r,n]);return{hybrid:h,uncompressed:u}}const Dt=Y;class le{static NAME=ot.P2PKH;#o;#a;#n;#i;#t;#e;#r;#s;#h=!1;#u=!1;#f;#c;#w;#y;#g;#l;#d;#p=!1;#m=!1;#E=!1;#v=!1;#O=!1;#b=!1;#P=!1;#A;#I=!1;#T;#U=!1;constructor(t,r){this.#o=t.network??Ut,this.#a={validate:r?.validate??!0,allowIncomplete:r?.allowIncomplete??!1},this.#n=t.address,this.#i=t.hash,this.#t=t.pubkey,this.#e=t.signature,this.#r=t.output,this.#s=t.input,this.#h=t.useHybrid??!1,this.#u=t.useUncompressed??!1,this.#a.validate&&this.#C()}get name(){return ot.P2PKH}get network(){return this.#o}get address(){return this.#p||(this.#f=this.#k(),this.#p=!0),this.#f}get hash(){return this.#m||(this.#c=this.#x(),this.#m=!0),this.#c}get pubkey(){return this.#E||(this.#w=this.#_(),this.#E=!0),this.#w}get signature(){return this.#v||(this.#y=this.#S(),this.#v=!0),this.#y}get output(){return this.#O||(this.#g=this.#N(),this.#O=!0),this.#g}get input(){return this.#b||(this.#l=this.#L(),this.#b=!0),this.#l}get witness(){return this.#P||(this.#d=this.#H(),this.#P=!0),this.#d}static fromPubkey(t,r){return new le({pubkey:t,network:r})}static fromAddress(t,r){return new le({address:t,network:r})}static fromHash(t,r){return new le({hash:t,network:r})}static fromOutput(t,r){return new le({output:t,network:r})}toPayment(){return{name:this.name,network:this.network,address:this.address,hash:this.hash,pubkey:this.pubkey,signature:this.signature,output:this.output,input:this.input,witness:this.witness}}#B(){if(!this.#I){if(this.#n){const t=new Uint8Array($n(this.#n));this.#A={version:t[0],hash:t.subarray(1)}}this.#I=!0}return this.#A}#R(){return this.#U||(this.#s&&(this.#T=ht(this.#s)??void 0),this.#U=!0),this.#T}#k(){if(this.#n)return this.#n;const t=this.hash;if(!t)return;const r=fe(21);return r[0]=this.#o.pubKeyHash,r.set(t,1),Mn(r)}#x(){if(this.#i)return this.#i;if(this.#r)return this.#r.subarray(3,23);if(this.#n)return this.#B()?.hash;const t=this.pubkey;if(t)return At(t)}#_(){if(this.#t)return this.#t;if(this.#s){const t=this.#R();if(t&&t.length>=2)return t[1]}}#S(){if(this.#e)return this.#e;if(this.#s){const t=this.#R();if(t&&t.length>=1)return t[0]}}#N(){if(this.#r)return this.#r;const t=this.hash;if(t)return dt([Dt.OP_DUP,Dt.OP_HASH160,t,Dt.OP_EQUALVERIFY,Dt.OP_CHECKSIG])}#L(){if(this.#s)return this.#s;if(!this.#t||!this.#e)return;let t=this.#t;if(this.#h||this.#u){const r=un(this.#t);r&&(this.#u?t=r.uncompressed:t=r.hybrid)}return dt([this.#e,t])}#H(){if(this.input)return[]}#C(){let t=new Uint8Array(0);if(this.#n){const r=this.#B();if(!r)throw new TypeError("Invalid address");if(r.version!==this.#o.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(r.hash.length!==20)throw new TypeError("Invalid address");t=r.hash}if(this.#i){if(t.length>0&&!$(t,this.#i))throw new TypeError("Hash mismatch");t=this.#i}if(this.#r){if(this.#r.length!==25||this.#r[0]!==Dt.OP_DUP||this.#r[1]!==Dt.OP_HASH160||this.#r[2]!==20||this.#r[23]!==Dt.OP_EQUALVERIFY||this.#r[24]!==Dt.OP_CHECKSIG)throw new TypeError("Output is invalid");const r=this.#r.subarray(3,23);if(t.length>0&&!$(t,r))throw new TypeError("Hash mismatch");t=r}if(this.#t){const r=At(this.#t);let n=t.length>0&&!$(t,r);if(n&&(this.#t.length===33&&(this.#t[0]===2||this.#t[0]===3)||this.#t.length===65&&this.#t[0]===4)){const o=un(this.#t);if(o){const h=At(o.uncompressed);if($(t,h))n=!1,this.#u=!0;else{const u=At(o.hybrid);n=!$(t,u),n||(this.#h=!0)}}}if(n)throw new TypeError("Hash mismatch");t=r}if(this.#s){const r=this.#R();if(!r||r.length!==2)throw new TypeError("Input is invalid");if(!qe(r[0]))throw new TypeError("Input has invalid signature");if(!ne(r[1]))throw new TypeError("Input has invalid pubkey");if(this.#e&&!$(this.#e,r[0]))throw new TypeError("Signature mismatch");if(this.#t&&!$(this.#t,r[1]))throw new TypeError("Pubkey mismatch");const n=At(r[1]);if(t.length>0&&!$(t,n))throw new TypeError("Hash mismatch (input)")}}}const ae=Y;class de{static NAME=ot.P2SH;#o;#a;#n;#i;#t;#e;#r;#s;#h;#u;#f;#c;#w;#y;#g=!1;#l=!1;#d=!1;#p=!1;#m=!1;#E=!1;#v;#O=!1;#b;#P=!1;#A;#I=!1;constructor(t,r){let n=t.network;n||(n=t.redeem&&t.redeem.network||Ut),this.#o=n,this.#a={validate:r?.validate??!0,allowIncomplete:r?.allowIncomplete??!1},this.#n=t.address,this.#i=t.hash,this.#t=t.output,this.#e=t.input,this.#r=t.redeem,this.#s=t.witness,this.#a.validate&&this.#H()}get name(){const t=this.redeem;return t!==void 0&&t.name!==void 0?`p2sh-${t.name}`:ot.P2SH}get network(){return this.#o}get address(){return this.#g||(this.#h=this.#R(),this.#g=!0),this.#h}get hash(){return this.#l||(this.#u=this.#k(),this.#l=!0),this.#u}get output(){return this.#d||(this.#f=this.#x(),this.#d=!0),this.#f}get input(){return this.#p||(this.#c=this.#_(),this.#p=!0),this.#c}get redeem(){return this.#m||(this.#w=this.#S(),this.#m=!0),this.#w}get witness(){return this.#E||(this.#y=this.#N(),this.#E=!0),this.#y}static fromRedeem(t,r){return new de({redeem:t,network:r})}static fromAddress(t,r){return new de({address:t,network:r})}static fromHash(t,r){return new de({hash:t,network:r})}static fromOutput(t,r){return new de({output:t,network:r})}toPayment(){return{name:this.name,network:this.network,address:this.address,hash:this.hash,output:this.output,input:this.input,redeem:this.redeem,witness:this.witness}}#T(){if(!this.#O){if(this.#n){const t=new Uint8Array($n(this.#n));this.#v={version:t[0],hash:t.subarray(1)}}this.#O=!0}return this.#v}#U(){return this.#P||(this.#e&&(this.#b=ht(this.#e)??void 0),this.#P=!0),this.#b}#B(){if(!this.#I){const t=this.#U();if(t){const r=t[t.length-1];this.#A={network:this.#o,output:r===ae.OP_FALSE?new Uint8Array(0):r,input:dt(t.slice(0,-1)),witness:this.#s||[]}}this.#I=!0}return this.#A}#R(){if(this.#n)return this.#n;const t=this.hash;if(!t)return;const r=fe(21);return r[0]=this.#o.scriptHash,r.set(t,1),Mn(r)}#k(){if(this.#i)return this.#i;if(this.#t)return this.#t.subarray(2,22);if(this.#n)return this.#T()?.hash;const t=this.redeem;if(t&&t.output)return At(t.output)}#x(){if(this.#t)return this.#t;const t=this.hash;if(t)return dt([ae.OP_HASH160,t,ae.OP_EQUAL])}#_(){if(this.#e)return this.#e;const t=this.#r;if(!(!t||!t.input||!t.output))return dt([].concat(ht(t.input),t.output))}#S(){if(this.#r)return this.#r;if(this.#e)return this.#B()}#N(){if(this.#s)return this.#s;const t=this.redeem;if(t&&t.witness)return t.witness;if(this.input)return[]}#L(t){if(t.output){const r=ht(t.output);if(!r||r.length<1)throw new TypeError("Redeem.output too short");if(t.output.byteLength>520)throw new TypeError("Redeem.output unspendable if larger than 520 bytes");if(Wn(r)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops")}if(t.input){const r=t.input.length>0,n=t.witness&&t.witness.length>0;if(!r&&!n)throw new TypeError("Empty input");if(r&&n)throw new TypeError("Input and witness provided");if(r){const o=ht(t.input);if(!xr(o))throw new TypeError("Non push-only scriptSig")}}}#H(){let t=new Uint8Array(0);if(this.#n){const r=this.#T();if(!r)throw new TypeError("Invalid address");if(r.version!==this.#o.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(r.hash.length!==20)throw new TypeError("Invalid address");t=r.hash}if(this.#i){if(t.length>0&&!$(t,this.#i))throw new TypeError("Hash mismatch");t=this.#i}if(this.#t){if(this.#t.length!==23||this.#t[0]!==ae.OP_HASH160||this.#t[1]!==20||this.#t[22]!==ae.OP_EQUAL)throw new TypeError("Output is invalid");const r=this.#t.subarray(2,22);if(t.length>0&&!$(t,r))throw new TypeError("Hash mismatch");t=r}if(this.#e){const r=this.#U();if(!r||r.length<1)throw new TypeError("Input too short");const n=this.#B();if(!n||!(n.output instanceof Uint8Array))throw new TypeError("Input is invalid");if(this.#L(n),n.output){const o=At(n.output);if(t.length>0&&!$(t,o))throw new TypeError("Hash mismatch");t=o}}if(this.#r){if(this.#r.network&&this.#r.network!==this.#o)throw new TypeError("Network mismatch");if(this.#e){const r=this.#B();if(r){if(this.#r.output&&r.output&&!$(this.#r.output,r.output))throw new TypeError("Redeem.output mismatch");if(this.#r.input&&r.input&&!$(this.#r.input,r.input))throw new TypeError("Redeem.input mismatch")}}if(this.#L(this.#r),this.#r.output){const r=At(this.#r.output);if(t.length>0&&!$(t,r))throw new TypeError("Hash mismatch")}}if(this.#s&&this.#r&&this.#r.witness&&!ie(this.#r.witness,this.#s))throw new TypeError("Witness and redeem.witness mismatch")}}function Ro(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let d=0;d<t.length;d++)t[d]=255;for(let d=0;d<e.length;d++){const a=e.charAt(d),y=a.charCodeAt(0);if(t[y]!==255)throw new TypeError(a+" is ambiguous");t[y]=d}const r=e.length,n=e.charAt(0),o=Math.log(r)/Math.log(256),h=Math.log(256)/Math.log(r);function u(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";let a=0,y=0,m=0;const b=d.length;for(;m!==b&&d[m]===0;)m++,a++;const v=(b-m)*h+1>>>0,E=new Uint8Array(v);for(;m!==b;){let L=d[m],D=0;for(let V=v-1;(L!==0||D<y)&&V!==-1;V--,D++)L+=256*E[V]>>>0,E[V]=L%r>>>0,L=L/r>>>0;if(L!==0)throw new Error("Non-zero carry");y=D,m++}let T=v-y;for(;T!==v&&E[T]===0;)T++;let x=n.repeat(a);for(;T<v;++T)x+=e.charAt(E[T]);return x}function c(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;let a=0,y=0,m=0;for(;d[a]===n;)y++,a++;const b=(d.length-a)*o+1>>>0,v=new Uint8Array(b);for(;a<d.length;){const L=d.charCodeAt(a);if(L>255)return;let D=t[L];if(D===255)return;let V=0;for(let K=b-1;(D!==0||V<m)&&K!==-1;K--,V++)D+=r*v[K]>>>0,v[K]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");m=V,a++}let E=b-m;for(;E!==b&&v[E]===0;)E++;const T=new Uint8Array(y+(b-E));let x=y;for(;E!==b;)T[x++]=v[E++];return T}function p(d){const a=c(d);if(a)return a;throw new Error("Non-base"+r+" character")}return{encode:u,decodeUnsafe:c,decode:p}}var ko="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";Ro(ko);function xo(e){const t=e.length;if(t%2!==0)throw new TypeError("fromHexInternal: odd-length hex string");const r=new Uint8Array(t/2);for(let n=0;n<t;n+=2){const o=an(e.charCodeAt(n)),h=an(e.charCodeAt(n+1));if(o===-1||h===-1)throw new TypeError("fromHexInternal: invalid hex character");r[n>>1]=o<<4|h}return r}function an(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function ct(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Lr(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function zt(e,t=""){if(!Number.isSafeInteger(e)||e<0){const r=t&&`"${t}" `;throw new Error(`${r}expected integer >= 0, got ${e}`)}}function tt(e,t,r=""){const n=Lr(e),o=e?.length,h=t!==void 0;if(!n||h&&o!==t){const u=r&&`"${r}" `,c=h?` of length ${t}`:"",p=n?`length=${o}`:`type=${typeof e}`;throw new Error(u+"expected Uint8Array"+c+", got "+p)}return e}function ai(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");zt(e.outputLen),zt(e.blockLen)}function He(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function _o(e,t){tt(e,void 0,"digestInto() output");const r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function De(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function rr(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Tt(e,t){return e<<32-t|e>>>t}const ci=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",So=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function We(e){if(tt(e),ci)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=So[e[r]];return t}const xt={_0:48,_9:57,A:65,F:70,a:97,f:102};function cn(e){if(e>=xt._0&&e<=xt._9)return e-xt._0;if(e>=xt.A&&e<=xt.F)return e-(xt.A-10);if(e>=xt.a&&e<=xt.f)return e-(xt.a-10)}function Ve(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(ci)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let o=0,h=0;o<r;o++,h+=2){const u=cn(e.charCodeAt(h)),c=cn(e.charCodeAt(h+1));if(u===void 0||c===void 0){const p=e[h]+e[h+1];throw new Error('hex string expected, got non-hex character "'+p+'" at index '+h)}n[o]=u*16+c}return n}function Kt(...e){let t=0;for(let n=0;n<e.length;n++){const o=e[n];tt(o),t+=o.length}const r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){const h=e[n];r.set(h,o),o+=h.length}return r}function No(e,t={}){const r=(o,h)=>e(h).update(o).digest(),n=e(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=o=>e(o),Object.assign(r,t),Object.freeze(r)}function li(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}const Lo=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function Co(e,t,r){return e&t^~e&r}function Ho(e,t,r){return e&t^e&r^t&r}class Do{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,n,o){this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=rr(this.buffer)}update(t){He(this),tt(t);const{view:r,buffer:n,blockLen:o}=this,h=t.length;for(let u=0;u<h;){const c=Math.min(o-this.pos,h-u);if(c===o){const p=rr(t);for(;o<=h-u;u+=o)this.process(p,u);continue}n.set(t.subarray(u,u+c),this.pos),this.pos+=c,u+=c,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){He(this),_o(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:h}=this;let{pos:u}=this;r[u++]=128,De(this.buffer.subarray(u)),this.padOffset>o-u&&(this.process(n,0),u=0);for(let y=u;y<o;y++)r[y]=0;n.setBigUint64(o-8,BigInt(this.length*8),h),this.process(n,0);const c=rr(t),p=this.outputLen;if(p%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const d=p/4,a=this.get();if(d>a.length)throw new Error("_sha2: outputLen bigger than state");for(let y=0;y<d;y++)c.setUint32(4*y,a[y],h)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:h,destroyed:u,pos:c}=this;return t.destroyed=u,t.finished=h,t.length=o,t.pos=c,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const Vt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Vo=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ft=new Uint32Array(64);class Fo extends Do{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:r,C:n,D:o,E:h,F:u,G:c,H:p}=this;return[t,r,n,o,h,u,c,p]}set(t,r,n,o,h,u,c,p){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=h|0,this.F=u|0,this.G=c|0,this.H=p|0}process(t,r){for(let y=0;y<16;y++,r+=4)Ft[y]=t.getUint32(r,!1);for(let y=16;y<64;y++){const m=Ft[y-15],b=Ft[y-2],v=Tt(m,7)^Tt(m,18)^m>>>3,E=Tt(b,17)^Tt(b,19)^b>>>10;Ft[y]=E+Ft[y-7]+v+Ft[y-16]|0}let{A:n,B:o,C:h,D:u,E:c,F:p,G:d,H:a}=this;for(let y=0;y<64;y++){const m=Tt(c,6)^Tt(c,11)^Tt(c,25),b=a+m+Co(c,p,d)+Vo[y]+Ft[y]|0,v=(Tt(n,2)^Tt(n,13)^Tt(n,22))+Ho(n,o,h)|0;a=d,d=p,p=c,c=u+b|0,u=h,h=o,o=n,n=b+v|0}n=n+this.A|0,o=o+this.B|0,h=h+this.C|0,u=u+this.D|0,c=c+this.E|0,p=p+this.F|0,d=d+this.G|0,a=a+this.H|0,this.set(n,o,h,u,c,p,d,a)}roundClean(){De(Ft)}destroy(){this.set(0,0,0,0,0,0,0,0),De(this.buffer)}}class Mo extends Fo{A=Vt[0]|0;B=Vt[1]|0;C=Vt[2]|0;D=Vt[3]|0;E=Vt[4]|0;F=Vt[5]|0;G=Vt[6]|0;H=Vt[7]|0;constructor(){super(32)}}const $o=No(()=>new Mo,Lo(1)),Cr=BigInt(0),mr=BigInt(1);function Fe(e,t=""){if(typeof e!="boolean"){const r=t&&`"${t}" `;throw new Error(r+"expected boolean, got type="+typeof e)}return e}function di(e){if(typeof e=="bigint"){if(!_e(e))throw new Error("positive bigint expected, got "+e)}else zt(e);return e}function Ie(e){const t=di(e).toString(16);return t.length&1?"0"+t:t}function pi(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Cr:BigInt("0x"+e)}function Ze(e){return pi(We(e))}function wi(e){return pi(We(Ko(tt(e)).reverse()))}function Hr(e,t){zt(t),e=di(e);const r=Ve(e.toString(16).padStart(t*2,"0"));if(r.length!==t)throw new Error("number too large");return r}function yi(e,t){return Hr(e,t).reverse()}function Ko(e){return Uint8Array.from(e)}const _e=e=>typeof e=="bigint"&&Cr<=e;function jo(e,t,r){return _e(e)&&_e(t)&&_e(r)&&t<=e&&e<r}function Go(e,t,r,n){if(!jo(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function qo(e){let t;for(t=0;e>Cr;e>>=mr,t+=1);return t}const Dr=e=>(mr<<BigInt(e))-mr;function Yo(e,t,r){if(zt(e,"hashLen"),zt(t,"qByteLen"),typeof r!="function")throw new Error("hmacFn must be a function");const n=E=>new Uint8Array(E),o=Uint8Array.of(),h=Uint8Array.of(0),u=Uint8Array.of(1),c=1e3;let p=n(e),d=n(e),a=0;const y=()=>{p.fill(1),d.fill(0),a=0},m=(...E)=>r(d,Kt(p,...E)),b=(E=o)=>{d=m(h,E),p=m(),E.length!==0&&(d=m(u,E),p=m())},v=()=>{if(a++>=c)throw new Error("drbg: tried max amount of iterations");let E=0;const T=[];for(;E<t;){p=m();const x=p.slice();T.push(x),E+=p.length}return Kt(...T)};return(E,T)=>{y(),b(E);let x;for(;!(x=T(v()));)b();return y(),x}}function Vr(e,t={},r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(h,u,c){const p=e[h];if(c&&p===void 0)return;const d=typeof p;if(d!==u||p===null)throw new Error(`param "${h}" is invalid: expected ${u}, got ${d}`)}const o=(h,u)=>Object.entries(h).forEach(([c,p])=>n(c,p,u));o(t,!1),o(r,!0)}function ln(e){const t=new WeakMap;return(r,...n)=>{const o=t.get(r);if(o!==void 0)return o;const h=e(r,...n);return t.set(r,h),h}}const lt=BigInt(0),at=BigInt(1),Yt=BigInt(2),gi=BigInt(3),bi=BigInt(4),mi=BigInt(5),Wo=BigInt(7),Ei=BigInt(8),Zo=BigInt(9),vi=BigInt(16);function Ot(e,t){const r=e%t;return r>=lt?r:t+r}function gt(e,t,r){let n=e;for(;t-- >lt;)n*=n,n%=r;return n}function dn(e,t){if(e===lt)throw new Error("invert: expected non-zero number");if(t<=lt)throw new Error("invert: expected positive modulus, got "+t);let r=Ot(e,t),n=t,o=lt,h=at;for(;r!==lt;){const u=n/r,c=n%r,p=o-h*u;n=r,r=c,o=h,h=p}if(n!==at)throw new Error("invert: does not exist");return Ot(o,t)}function Fr(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function Oi(e,t){const r=(e.ORDER+at)/bi,n=e.pow(t,r);return Fr(e,n,t),n}function Xo(e,t){const r=(e.ORDER-mi)/Ei,n=e.mul(t,Yt),o=e.pow(n,r),h=e.mul(t,o),u=e.mul(e.mul(h,Yt),o),c=e.mul(h,e.sub(u,e.ONE));return Fr(e,c,t),c}function zo(e){const t=Xe(e),r=Ai(e),n=r(t,t.neg(t.ONE)),o=r(t,n),h=r(t,t.neg(n)),u=(e+Wo)/vi;return(c,p)=>{let d=c.pow(p,u),a=c.mul(d,n);const y=c.mul(d,o),m=c.mul(d,h),b=c.eql(c.sqr(a),p),v=c.eql(c.sqr(y),p);d=c.cmov(d,a,b),a=c.cmov(m,y,v);const E=c.eql(c.sqr(a),p),T=c.cmov(d,a,E);return Fr(c,T,p),T}}function Ai(e){if(e<gi)throw new Error("sqrt is not defined for small field");let t=e-at,r=0;for(;t%Yt===lt;)t/=Yt,r++;let n=Yt;const o=Xe(e);for(;pn(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return Oi;let h=o.pow(n,t);const u=(t+at)/Yt;return function(c,p){if(c.is0(p))return p;if(pn(c,p)!==1)throw new Error("Cannot find square root");let d=r,a=c.mul(c.ONE,h),y=c.pow(p,t),m=c.pow(p,u);for(;!c.eql(y,c.ONE);){if(c.is0(y))return c.ZERO;let b=1,v=c.sqr(y);for(;!c.eql(v,c.ONE);)if(b++,v=c.sqr(v),b===d)throw new Error("Cannot find square root");const E=at<<BigInt(d-b-1),T=c.pow(a,E);d=b,a=c.sqr(T),y=c.mul(y,a),m=c.mul(m,T)}return m}}function Qo(e){return e%bi===gi?Oi:e%Ei===mi?Xo:e%vi===Zo?zo(e):Ai(e)}const Jo=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function tf(e){const t={ORDER:"bigint",BYTES:"number",BITS:"number"},r=Jo.reduce((n,o)=>(n[o]="function",n),t);return Vr(e,r),e}function ef(e,t,r){if(r<lt)throw new Error("invalid exponent, negatives unsupported");if(r===lt)return e.ONE;if(r===at)return t;let n=e.ONE,o=t;for(;r>lt;)r&at&&(n=e.mul(n,o)),o=e.sqr(o),r>>=at;return n}function Pi(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),o=t.reduce((u,c,p)=>e.is0(c)?u:(n[p]=u,e.mul(u,c)),e.ONE),h=e.inv(o);return t.reduceRight((u,c,p)=>e.is0(c)?u:(n[p]=e.mul(u,n[p]),e.mul(u,c)),h),n}function pn(e,t){const r=(e.ORDER-at)/Yt,n=e.pow(t,r),o=e.eql(n,e.ONE),h=e.eql(n,e.ZERO),u=e.eql(n,e.neg(e.ONE));if(!o&&!h&&!u)throw new Error("invalid Legendre symbol result");return o?1:h?0:-1}function rf(e,t){t!==void 0&&zt(t);const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}class nf{ORDER;BITS;BYTES;isLE;ZERO=lt;ONE=at;_lengths;_sqrt;_mod;constructor(t,r={}){if(t<=lt)throw new Error("invalid field: expected ORDER > 0, got "+t);let n;this.isLE=!1,r!=null&&typeof r=="object"&&(typeof r.BITS=="number"&&(n=r.BITS),typeof r.sqrt=="function"&&(this.sqrt=r.sqrt),typeof r.isLE=="boolean"&&(this.isLE=r.isLE),r.allowedLengths&&(this._lengths=r.allowedLengths?.slice()),typeof r.modFromBytes=="boolean"&&(this._mod=r.modFromBytes));const{nBitLength:o,nByteLength:h}=rf(t,n);if(h>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=o,this.BYTES=h,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return Ot(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return lt<=t&&t<this.ORDER}is0(t){return t===lt}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&at)===at}neg(t){return Ot(-t,this.ORDER)}eql(t,r){return t===r}sqr(t){return Ot(t*t,this.ORDER)}add(t,r){return Ot(t+r,this.ORDER)}sub(t,r){return Ot(t-r,this.ORDER)}mul(t,r){return Ot(t*r,this.ORDER)}pow(t,r){return ef(this,t,r)}div(t,r){return Ot(t*dn(r,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,r){return t+r}subN(t,r){return t-r}mulN(t,r){return t*r}inv(t){return dn(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=Qo(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?yi(t,this.BYTES):Hr(t,this.BYTES)}fromBytes(t,r=!1){tt(t);const{_lengths:n,BYTES:o,isLE:h,ORDER:u,_mod:c}=this;if(n){if(!n.includes(t.length)||t.length>o)throw new Error("Field.fromBytes: expected "+n+" bytes, got "+t.length);const d=new Uint8Array(o);d.set(t,h?0:d.length-t.length),t=d}if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);let p=h?wi(t):Ze(t);if(c&&(p=Ot(p,u)),!r&&!this.isValid(p))throw new Error("invalid field element: outside of range 0..ORDER");return p}invertBatch(t){return Pi(this,t)}cmov(t,r,n){return n?r:t}}function Xe(e,t={}){return new nf(e,t)}function Ii(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Ti(e){const t=Ii(e);return t+Math.ceil(t/2)}function sf(e,t,r=!1){tt(e);const n=e.length,o=Ii(t),h=Ti(t);if(n<16||n<h||n>1024)throw new Error("expected "+h+"-1024 bytes of input, got "+n);const u=r?wi(e):Ze(e),c=Ot(u,t-at)+at;return r?yi(c,o):Hr(c,o)}const se=BigInt(0),Wt=BigInt(1);function Me(e,t){const r=t.negate();return e?r:t}function wn(e,t){const r=Pi(e.Fp,t.map(n=>n.Z));return t.map((n,o)=>e.fromAffine(n.toAffine(r[o])))}function Bi(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function nr(e,t){Bi(e,t);const r=Math.ceil(t/e)+1,n=2**(e-1),o=2**e,h=Dr(e),u=BigInt(e);return{windows:r,windowSize:n,mask:h,maxNumber:o,shiftBy:u}}function yn(e,t,r){const{windowSize:n,mask:o,maxNumber:h,shiftBy:u}=r;let c=Number(e&o),p=e>>u;c>n&&(c-=h,p+=Wt);const d=t*n,a=d+Math.abs(c)-1,y=c===0,m=c<0,b=t%2!==0;return{nextN:p,offset:a,isZero:y,isNeg:m,isNegF:b,offsetF:d}}const ir=new WeakMap,Ui=new WeakMap;function sr(e){return Ui.get(e)||1}function gn(e){if(e!==se)throw new Error("invalid wNAF")}class of{BASE;ZERO;Fn;bits;constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let o=t;for(;r>se;)r&Wt&&(n=n.add(o)),o=o.double(),r>>=Wt;return n}precomputeWindow(t,r){const{windows:n,windowSize:o}=nr(r,this.bits),h=[];let u=t,c=u;for(let p=0;p<n;p++){c=u,h.push(c);for(let d=1;d<o;d++)c=c.add(u),h.push(c);u=c.double()}return h}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let o=this.ZERO,h=this.BASE;const u=nr(t,this.bits);for(let c=0;c<u.windows;c++){const{nextN:p,offset:d,isZero:a,isNeg:y,isNegF:m,offsetF:b}=yn(n,c,u);n=p,a?h=h.add(Me(m,r[b])):o=o.add(Me(y,r[d]))}return gn(n),{p:o,f:h}}wNAFUnsafe(t,r,n,o=this.ZERO){const h=nr(t,this.bits);for(let u=0;u<h.windows&&n!==se;u++){const{nextN:c,offset:p,isZero:d,isNeg:a}=yn(n,u,h);if(n=c,!d){const y=r[p];o=o.add(a?y.negate():y)}}return gn(n),o}getPrecomputes(t,r,n){let o=ir.get(r);return o||(o=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(o=n(o)),ir.set(r,o))),o}cached(t,r,n){const o=sr(t);return this.wNAF(o,this.getPrecomputes(o,t,n),r)}unsafe(t,r,n,o){const h=sr(t);return h===1?this._unsafeLadder(t,r,o):this.wNAFUnsafe(h,this.getPrecomputes(h,t,n),r,o)}createCache(t,r){Bi(r,this.bits),Ui.set(t,r),ir.delete(t)}hasCache(t){return sr(t)!==1}}function ff(e,t,r,n){let o=t,h=e.ZERO,u=e.ZERO;for(;r>se||n>se;)r&Wt&&(h=h.add(o)),n&Wt&&(u=u.add(o)),o=o.double(),r>>=Wt,n>>=Wt;return{p1:h,p2:u}}function bn(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return tf(t),t}else return Xe(e,{isLE:r})}function hf(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const c of["p","n","h"]){const p=t[c];if(!(typeof p=="bigint"&&p>se))throw new Error(`CURVE.${c} must be positive bigint`)}const o=bn(t.p,r.Fp,n),h=bn(t.n,r.Fn,n),u=["Gx","Gy","a","b"];for(const c of u)if(!o.isValid(t[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:h}}function uf(e,t){return function(r){const n=e(r);return{secretKey:n,publicKey:t(n)}}}class Ri{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){if(ai(t),tt(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,o=new Uint8Array(n);o.set(r.length>n?t.create().update(r).digest():r);for(let h=0;h<o.length;h++)o[h]^=54;this.iHash.update(o),this.oHash=t.create();for(let h=0;h<o.length;h++)o[h]^=106;this.oHash.update(o),De(o)}update(t){return He(this),this.iHash.update(t),this}digestInto(t){He(this),tt(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:r,iHash:n,finished:o,destroyed:h,blockLen:u,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=h,t.blockLen=u,t.outputLen=c,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ki=(e,t,r)=>new Ri(e,t).update(r).digest();ki.create=(e,t)=>new Ri(e,t);const mn=(e,t)=>(e+(e>=0?t:-t)/xi)/t;function af(e,t,r){const[[n,o],[h,u]]=t,c=mn(u*e,r),p=mn(-o*e,r);let d=e-c*n-p*h,a=-c*o-p*u;const y=d<St,m=a<St;y&&(d=-d),m&&(a=-a);const b=Dr(Math.ceil(qo(r)/2))+re;if(d<St||d>=b||a<St||a>=b)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:y,k1:d,k2neg:m,k2:a}}function Er(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function or(e,t){const r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return Fe(r.lowS,"lowS"),Fe(r.prehash,"prehash"),r.format!==void 0&&Er(r.format),r}class cf extends Error{constructor(t=""){super(t)}}const Mt={Err:cf,_tlv:{encode:(e,t)=>{const{Err:r}=Mt;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");const n=t.length/2,o=Ie(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");const h=n>127?Ie(o.length/2|128):"";return Ie(e)+h+o+t},decode(e,t){const{Err:r}=Mt;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const o=t[n++],h=!!(o&128);let u=0;if(!h)u=o;else{const p=o&127;if(!p)throw new r("tlv.decode(long): indefinite length not supported");if(p>4)throw new r("tlv.decode(long): byte length is too big");const d=t.subarray(n,n+p);if(d.length!==p)throw new r("tlv.decode: length bytes not complete");if(d[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const a of d)u=u<<8|a;if(n+=p,u<128)throw new r("tlv.decode(long): not minimal encoding")}const c=t.subarray(n,n+u);if(c.length!==u)throw new r("tlv.decode: wrong value length");return{v:c,l:t.subarray(n+u)}}},_int:{encode(e){const{Err:t}=Mt;if(e<St)throw new t("integer: negative integers are not allowed");let r=Ie(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=Mt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Ze(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=Mt,o=tt(e,void 0,"signature"),{v:h,l:u}=n.decode(48,o);if(u.length)throw new t("invalid signature: left bytes after parsing");const{v:c,l:p}=n.decode(2,h),{v:d,l:a}=n.decode(2,p);if(a.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(c),s:r.decode(d)}},hexFromSig(e){const{_tlv:t,_int:r}=Mt,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),h=n+o;return t.encode(48,h)}},St=BigInt(0),re=BigInt(1),xi=BigInt(2),Te=BigInt(3),lf=BigInt(4);function df(e,t={}){const r=hf("weierstrass",e,t),{Fp:n,Fn:o}=r;let h=r.CURVE;const{h:u,n:c}=h;Vr(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});const{endo:p}=t;if(p&&(!n.is0(h.a)||typeof p.beta!="bigint"||!Array.isArray(p.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const d=Si(n,o);function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function y(G,I,A){const{x:O,y:B}=I.toAffine(),_=n.toBytes(O);if(Fe(A,"isCompressed"),A){a();const S=!n.isOdd(B);return Kt(_i(S),_)}else return Kt(Uint8Array.of(4),_,n.toBytes(B))}function m(G){tt(G,void 0,"Point");const{publicKey:I,publicKeyUncompressed:A}=d,O=G.length,B=G[0],_=G.subarray(1);if(O===I&&(B===2||B===3)){const S=n.fromBytes(_);if(!n.isValid(S))throw new Error("bad point: is not on curve, wrong x");const N=E(S);let k;try{k=n.sqrt(N)}catch(F){const et=F instanceof Error?": "+F.message:"";throw new Error("bad point: is not on curve, sqrt error"+et)}a();const H=n.isOdd(k);return(B&1)===1!==H&&(k=n.neg(k)),{x:S,y:k}}else if(O===A&&B===4){const S=n.BYTES,N=n.fromBytes(_.subarray(0,S)),k=n.fromBytes(_.subarray(S,S*2));if(!T(N,k))throw new Error("bad point: is not on curve");return{x:N,y:k}}else throw new Error(`bad point: got length ${O}, expected compressed=${I} or uncompressed=${A}`)}const b=t.toBytes||y,v=t.fromBytes||m;function E(G){const I=n.sqr(G),A=n.mul(I,G);return n.add(n.add(A,n.mul(G,h.a)),h.b)}function T(G,I){const A=n.sqr(I),O=E(G);return n.eql(A,O)}if(!T(h.Gx,h.Gy))throw new Error("bad curve params: generator point");const x=n.mul(n.pow(h.a,Te),lf),L=n.mul(n.sqr(h.b),BigInt(27));if(n.is0(n.add(x,L)))throw new Error("bad curve params: a or b");function D(G,I,A=!1){if(!n.isValid(I)||A&&n.is0(I))throw new Error(`bad point coordinate ${G}`);return I}function V(G){if(!(G instanceof j))throw new Error("Weierstrass Point expected")}function K(G){if(!p||!p.basises)throw new Error("no endo");return af(G,p.basises,o.ORDER)}const J=ln((G,I)=>{const{X:A,Y:O,Z:B}=G;if(n.eql(B,n.ONE))return{x:A,y:O};const _=G.is0();I==null&&(I=_?n.ONE:n.inv(B));const S=n.mul(A,I),N=n.mul(O,I),k=n.mul(B,I);if(_)return{x:n.ZERO,y:n.ZERO};if(!n.eql(k,n.ONE))throw new Error("invZ was invalid");return{x:S,y:N}}),Nt=ln(G=>{if(G.is0()){if(t.allowInfinityPoint&&!n.is0(G.Y))return;throw new Error("bad point: ZERO")}const{x:I,y:A}=G.toAffine();if(!n.isValid(I)||!n.isValid(A))throw new Error("bad point: x or y not field elements");if(!T(I,A))throw new Error("bad point: equation left != right");if(!G.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function it(G,I,A,O,B){return A=new j(n.mul(A.X,G),A.Y,A.Z),I=Me(O,I),A=Me(B,A),I.add(A)}class j{static BASE=new j(h.Gx,h.Gy,n.ONE);static ZERO=new j(n.ZERO,n.ONE,n.ZERO);static Fp=n;static Fn=o;X;Y;Z;constructor(I,A,O){this.X=D("x",I),this.Y=D("y",A,!0),this.Z=D("z",O),Object.freeze(this)}static CURVE(){return h}static fromAffine(I){const{x:A,y:O}=I||{};if(!I||!n.isValid(A)||!n.isValid(O))throw new Error("invalid affine point");if(I instanceof j)throw new Error("projective point not allowed");return n.is0(A)&&n.is0(O)?j.ZERO:new j(A,O,n.ONE)}static fromBytes(I){const A=j.fromAffine(v(tt(I,void 0,"point")));return A.assertValidity(),A}static fromHex(I){return j.fromBytes(Ve(I))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(I=8,A=!0){return Rt.createCache(this,I),A||this.multiply(Te),this}assertValidity(){Nt(this)}hasEvenY(){const{y:I}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(I)}equals(I){V(I);const{X:A,Y:O,Z:B}=this,{X:_,Y:S,Z:N}=I,k=n.eql(n.mul(A,N),n.mul(_,B)),H=n.eql(n.mul(O,N),n.mul(S,B));return k&&H}negate(){return new j(this.X,n.neg(this.Y),this.Z)}double(){const{a:I,b:A}=h,O=n.mul(A,Te),{X:B,Y:_,Z:S}=this;let N=n.ZERO,k=n.ZERO,H=n.ZERO,F=n.mul(B,B),et=n.mul(_,_),M=n.mul(S,S),C=n.mul(B,_);return C=n.add(C,C),H=n.mul(B,S),H=n.add(H,H),N=n.mul(I,H),k=n.mul(O,M),k=n.add(N,k),N=n.sub(et,k),k=n.add(et,k),k=n.mul(N,k),N=n.mul(C,N),H=n.mul(O,H),M=n.mul(I,M),C=n.sub(F,M),C=n.mul(I,C),C=n.add(C,H),H=n.add(F,F),F=n.add(H,F),F=n.add(F,M),F=n.mul(F,C),k=n.add(k,F),M=n.mul(_,S),M=n.add(M,M),F=n.mul(M,C),N=n.sub(N,F),H=n.mul(M,et),H=n.add(H,H),H=n.add(H,H),new j(N,k,H)}add(I){V(I);const{X:A,Y:O,Z:B}=this,{X:_,Y:S,Z:N}=I;let k=n.ZERO,H=n.ZERO,F=n.ZERO;const et=h.a,M=n.mul(h.b,Te);let C=n.mul(A,_),Z=n.mul(O,S),rt=n.mul(B,N),wt=n.add(A,O),X=n.add(_,S);wt=n.mul(wt,X),X=n.add(C,Z),wt=n.sub(wt,X),X=n.add(A,B);let st=n.add(_,N);return X=n.mul(X,st),st=n.add(C,rt),X=n.sub(X,st),st=n.add(O,B),k=n.add(S,N),st=n.mul(st,k),k=n.add(Z,rt),st=n.sub(st,k),F=n.mul(et,X),k=n.mul(M,rt),F=n.add(k,F),k=n.sub(Z,F),F=n.add(Z,F),H=n.mul(k,F),Z=n.add(C,C),Z=n.add(Z,C),rt=n.mul(et,rt),X=n.mul(M,X),Z=n.add(Z,rt),rt=n.sub(C,rt),rt=n.mul(et,rt),X=n.add(X,rt),C=n.mul(Z,X),H=n.add(H,C),C=n.mul(st,X),k=n.mul(wt,k),k=n.sub(k,C),C=n.mul(wt,Z),F=n.mul(st,F),F=n.add(F,C),new j(k,H,F)}subtract(I){return this.add(I.negate())}is0(){return this.equals(j.ZERO)}multiply(I){const{endo:A}=t;if(!o.isValidNot0(I))throw new Error("invalid scalar: out of range");let O,B;const _=S=>Rt.cached(this,S,N=>wn(j,N));if(A){const{k1neg:S,k1:N,k2neg:k,k2:H}=K(I),{p:F,f:et}=_(N),{p:M,f:C}=_(H);B=et.add(C),O=it(A.beta,F,M,S,k)}else{const{p:S,f:N}=_(I);O=S,B=N}return wn(j,[O,B])[0]}multiplyUnsafe(I){const{endo:A}=t,O=this;if(!o.isValid(I))throw new Error("invalid scalar: out of range");if(I===St||O.is0())return j.ZERO;if(I===re)return O;if(Rt.hasCache(this))return this.multiply(I);if(A){const{k1neg:B,k1:_,k2neg:S,k2:N}=K(I),{p1:k,p2:H}=ff(j,O,_,N);return it(A.beta,k,H,B,S)}else return Rt.unsafe(O,I)}toAffine(I){return J(this,I)}isTorsionFree(){const{isTorsionFree:I}=t;return u===re?!0:I?I(j,this):Rt.unsafe(this,c).is0()}clearCofactor(){const{clearCofactor:I}=t;return u===re?this:I?I(j,this):this.multiplyUnsafe(u)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}toBytes(I=!0){return Fe(I,"isCompressed"),this.assertValidity(),b(j,this,I)}toHex(I=!0){return We(this.toBytes(I))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const Et=o.BITS,Rt=new of(j,t.endo?Math.ceil(Et/2):Et);return j.BASE.precompute(8),j}function _i(e){return Uint8Array.of(e?2:3)}function Si(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function pf(e,t={}){const{Fn:r}=e,n=t.randomBytes||li,o=Object.assign(Si(e.Fp,r),{seed:Ti(r.ORDER)});function h(b){try{const v=r.fromBytes(b);return r.isValidNot0(v)}catch{return!1}}function u(b,v){const{publicKey:E,publicKeyUncompressed:T}=o;try{const x=b.length;return v===!0&&x!==E||v===!1&&x!==T?!1:!!e.fromBytes(b)}catch{return!1}}function c(b=n(o.seed)){return sf(tt(b,o.seed,"seed"),r.ORDER)}function p(b,v=!0){return e.BASE.multiply(r.fromBytes(b)).toBytes(v)}function d(b){const{secretKey:v,publicKey:E,publicKeyUncompressed:T}=o;if(!Lr(b)||"_lengths"in r&&r._lengths||v===E)return;const x=tt(b,void 0,"key").length;return x===E||x===T}function a(b,v,E=!0){if(d(b)===!0)throw new Error("first arg must be private key");if(d(v)===!1)throw new Error("second arg must be public key");const T=r.fromBytes(b);return e.fromBytes(v).multiply(T).toBytes(E)}const y={isValidSecretKey:h,isValidPublicKey:u,randomSecretKey:c},m=uf(c,p);return Object.freeze({getPublicKey:p,getSharedSecret:a,keygen:m,Point:e,utils:y,lengths:o})}function wf(e,t,r={}){ai(t),Vr(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),r=Object.assign({},r);const n=r.randomBytes||li,o=r.hmac||((A,O)=>ki(t,A,O)),{Fp:h,Fn:u}=e,{ORDER:c,BITS:p}=u,{keygen:d,getPublicKey:a,getSharedSecret:y,utils:m,lengths:b}=pf(e,r),v={prehash:!0,lowS:typeof r.lowS=="boolean"?r.lowS:!0,format:"compact",extraEntropy:!1},E=c*xi<h.ORDER;function T(A){const O=c>>re;return A>O}function x(A,O){if(!u.isValidNot0(O))throw new Error(`invalid signature ${A}: out of range 1..Point.Fn.ORDER`);return O}function L(){if(E)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function D(A,O){Er(O);const B=b.signature,_=O==="compact"?B:O==="recovered"?B+1:void 0;return tt(A,_)}class V{r;s;recovery;constructor(O,B,_){if(this.r=x("r",O),this.s=x("s",B),_!=null){if(L(),![0,1,2,3].includes(_))throw new Error("invalid recovery id");this.recovery=_}Object.freeze(this)}static fromBytes(O,B=v.format){D(O,B);let _;if(B==="der"){const{r:H,s:F}=Mt.toSig(tt(O));return new V(H,F)}B==="recovered"&&(_=O[0],B="compact",O=O.subarray(1));const S=b.signature/2,N=O.subarray(0,S),k=O.subarray(S,S*2);return new V(u.fromBytes(N),u.fromBytes(k),_)}static fromHex(O,B){return this.fromBytes(Ve(O),B)}assertRecovery(){const{recovery:O}=this;if(O==null)throw new Error("invalid recovery id: must be present");return O}addRecoveryBit(O){return new V(this.r,this.s,O)}recoverPublicKey(O){const{r:B,s:_}=this,S=this.assertRecovery(),N=S===2||S===3?B+c:B;if(!h.isValid(N))throw new Error("invalid recovery id: sig.r+curve.n != R.x");const k=h.toBytes(N),H=e.fromBytes(Kt(_i((S&1)===0),k)),F=u.inv(N),et=J(tt(O,void 0,"msgHash")),M=u.create(-et*F),C=u.create(_*F),Z=e.BASE.multiplyUnsafe(M).add(H.multiplyUnsafe(C));if(Z.is0())throw new Error("invalid recovery: point at infinify");return Z.assertValidity(),Z}hasHighS(){return T(this.s)}toBytes(O=v.format){if(Er(O),O==="der")return Ve(Mt.hexFromSig(this));const{r:B,s:_}=this,S=u.toBytes(B),N=u.toBytes(_);return O==="recovered"?(L(),Kt(Uint8Array.of(this.assertRecovery()),S,N)):Kt(S,N)}toHex(O){return We(this.toBytes(O))}}const K=r.bits2int||function(A){if(A.length>8192)throw new Error("input is too large");const O=Ze(A),B=A.length*8-p;return B>0?O>>BigInt(B):O},J=r.bits2int_modN||function(A){return u.create(K(A))},Nt=Dr(p);function it(A){return Go("num < 2^"+p,A,St,Nt),u.toBytes(A)}function j(A,O){return tt(A,void 0,"message"),O?tt(t(A),void 0,"prehashed message"):A}function Et(A,O,B){const{lowS:_,prehash:S,extraEntropy:N}=or(B,v);A=j(A,S);const k=J(A),H=u.fromBytes(O);if(!u.isValidNot0(H))throw new Error("invalid private key");const F=[it(H),it(k)];if(N!=null&&N!==!1){const Z=N===!0?n(b.secretKey):N;F.push(tt(Z,void 0,"extraEntropy"))}const et=Kt(...F),M=k;function C(Z){const rt=K(Z);if(!u.isValidNot0(rt))return;const wt=u.inv(rt),X=e.BASE.multiply(rt).toAffine(),st=u.create(X.x);if(st===St)return;const vt=u.create(wt*u.create(M+st*H));if(vt===St)return;let Qt=(X.x===st?0:2)|Number(X.y&re),he=vt;return _&&T(vt)&&(he=u.neg(vt),Qt^=1),new V(st,he,E?void 0:Qt)}return{seed:et,k2sig:C}}function Rt(A,O,B={}){const{seed:_,k2sig:S}=Et(A,O,B);return Yo(t.outputLen,u.BYTES,o)(_,S).toBytes(B.format)}function G(A,O,B,_={}){const{lowS:S,prehash:N,format:k}=or(_,v);if(B=tt(B,void 0,"publicKey"),O=j(O,N),!Lr(A)){const H=A instanceof V?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+H)}D(A,k);try{const H=V.fromBytes(A,k),F=e.fromBytes(B);if(S&&H.hasHighS())return!1;const{r:et,s:M}=H,C=J(O),Z=u.inv(M),rt=u.create(C*Z),wt=u.create(et*Z),X=e.BASE.multiplyUnsafe(rt).add(F.multiplyUnsafe(wt));return X.is0()?!1:u.create(X.x)===et}catch{return!1}}function I(A,O,B={}){const{prehash:_}=or(B,v);return O=j(O,_),V.fromBytes(A,"recovered").recoverPublicKey(O).toBytes()}return Object.freeze({keygen:d,getPublicKey:a,getSharedSecret:y,utils:m,lengths:b,Point:e,sign:Rt,verify:G,recoverPublicKey:I,Signature:V,hash:t})}const Mr={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},yf={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},En=BigInt(2);function gf(e){const t=Mr.p,r=BigInt(3),n=BigInt(6),o=BigInt(11),h=BigInt(22),u=BigInt(23),c=BigInt(44),p=BigInt(88),d=e*e*e%t,a=d*d*e%t,y=gt(a,r,t)*a%t,m=gt(y,r,t)*a%t,b=gt(m,En,t)*d%t,v=gt(b,o,t)*b%t,E=gt(v,h,t)*v%t,T=gt(E,c,t)*E%t,x=gt(T,p,t)*T%t,L=gt(x,c,t)*E%t,D=gt(L,r,t)*a%t,V=gt(D,u,t)*v%t,K=gt(V,n,t)*d%t,J=gt(K,En,t);if(!vr.eql(vr.sqr(J),e))throw new Error("Cannot find square root");return J}const vr=Xe(Mr.p,{sqrt:gf}),bf=df(Mr,{Fp:vr,endo:yf}),mf=wf(bf,$o),Ef=mf.Point;Ef.Fn.ORDER;function R(e){return xo(e)}function q(e,t){if(!e)throw new Error(`verifyCryptoBackend: ${t}`)}function vf(e){q(e.isPoint(R("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798")),"isPoint should accept generator point"),q(!e.isPoint(R("030000000000000000000000000000000000000000000000000000000000000005")),"isPoint should reject invalid point"),q(e.isXOnlyPoint(R("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798")),"isXOnlyPoint should accept generator x-coordinate"),q(!e.isXOnlyPoint(R("0000000000000000000000000000000000000000000000000000000000000005")),"isXOnlyPoint should reject x-coordinate not on curve"),q(!e.isXOnlyPoint(R("0000000000000000000000000000000000000000000000000000000000000000")),"isXOnlyPoint should reject zero"),q(!e.isXOnlyPoint(R("79be667ef9dcbbac55a06295ce870b07")),"isXOnlyPoint should reject wrong length"),q(e.isPrivate(R("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798")),"isPrivate should accept valid scalar"),q(e.isPrivate(R("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140")),"isPrivate should accept n-1"),q(!e.isPrivate(R("0000000000000000000000000000000000000000000000000000000000000000")),"isPrivate should reject zero"),q(!e.isPrivate(R("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141")),"isPrivate should reject n"),q(!e.isPrivate(R("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142")),"isPrivate should reject n+1");const t=e.privateAdd(R("0000000000000000000000000000000000000000000000000000000000000001"),R("0000000000000000000000000000000000000000000000000000000000000000"));q(t!==null&&ct(t,R("0000000000000000000000000000000000000000000000000000000000000001")),"privateAdd: 1 + 0 should equal 1"),q(e.privateAdd(R("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),R("0000000000000000000000000000000000000000000000000000000000000003"))===null,"privateAdd: (n-3) + 3 should return null (result is zero mod n)");const r=e.privateAdd(R("e211078564db65c3ce7704f08262b1f38f1ef412ad15b5ac2d76657a63b2c500"),R("b51fbb69051255d1becbd683de5848242a89c229348dd72896a87ada94ae8665"));q(r!==null&&ct(r,R("9730c2ee69edbb958d42db7460bafa18fef9d955325aec99044c81c8282b0a24")),"privateAdd: known vector failed"),q(ct(e.privateNegate(R("0000000000000000000000000000000000000000000000000000000000000001")),R("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140")),"privateNegate(1) should equal n-1"),q(ct(e.privateNegate(R("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e")),R("0000000000000000000000000000000000000000000000000000000000000003")),"privateNegate(n-3) should equal 3"),q(ct(e.privateNegate(R("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af")),R("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792")),"privateNegate known vector failed"),q(ct(e.pointCompress(R("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0),R("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798")),"pointCompress uncompressed->compressed failed"),q(ct(e.pointCompress(R("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1),R("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")),"pointCompress uncompressed->uncompressed failed"),q(ct(e.pointCompress(R("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0),R("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798")),"pointCompress compressed->compressed failed"),q(ct(e.pointCompress(R("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1),R("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")),"pointCompress compressed->uncompressed failed");const n=e.pointFromScalar(R("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"));q(n!==null&&ct(n,R("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99")),"pointFromScalar known vector failed"),q(e.xOnlyPointAddTweak(R("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),R("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))===null,"xOnlyPointAddTweak should return null for infinity result");let o=e.xOnlyPointAddTweak(R("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),R("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));q(o!==null&&ct(o.xOnlyPubkey,R("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&o.parity===1,"xOnlyPointAddTweak parity=1 case failed"),o=e.xOnlyPointAddTweak(R("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),R("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47")),q(o!==null&&ct(o.xOnlyPubkey,R("9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"))&&o.parity===0,"xOnlyPointAddTweak parity=0 case failed");const h=e.sign(R("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),R("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"));if(q(ct(h,R("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5")),"sign known vector failed"),q(e.verify(R("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),R("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),h),"verify known vector failed"),e.signSchnorr){const u=e.signSchnorr(R("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),R("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),R("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"));q(ct(u,R("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")),"signSchnorr known vector failed")}e.verifySchnorr&&q(e.verifySchnorr(R("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),R("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),R("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")),"verifySchnorr known vector failed")}class bt{static#o;#a;constructor(t){this.#a=t}get lib(){return this.#a}static init(t){return bt.#o&&bt.#o.#a===t?bt.#o:(vf(t),bt.#o=new bt(t),bt.#o)}static get(){if(!bt.#o)throw new Error("ECC library not initialized. Call EccContext.init() or initEccLib() first.");return bt.#o}static clear(){bt.#o=void 0}static isInitialized(){return bt.#o!==void 0}}function Of(){return bt.get().lib}const Or=192,Af=e=>"left"in e&&"right"in e;function vn(e,t){if(e.length<33)throw new TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);const r=(e.length-33)/32;let n=t;for(let o=0;o<r;o++){const h=e.subarray(33+32*o,65+32*o);me(n,h)<0?n=Pr(n,h):n=Pr(h,n)}return n}function Ar(e){if(Zs(e))return{hash:pe(e)};const t=[Ar(e[0]),Ar(e[1])];t.sort((o,h)=>me(o.hash,h.hash));const r=t[0],n=t[1];return{hash:Pr(r.hash,n.hash),left:r,right:n}}function $e(e,t){if(Af(e)){const r=$e(e.left,t);if(r!==void 0)return[...r,e.right.hash];const n=$e(e.right,t);if(n!==void 0)return[...n,e.left.hash]}else if($(e.hash,t))return[]}function pe(e){const t=e.version||Or;return _r("TapLeaf",jt([new Uint8Array([t]),If(e.output)]))}function Pf(e,t){return _r("TapTweak",t?jt([e,t]):e)}function Be(e,t){if(!(e instanceof Uint8Array)||e.length!==32||t&&t.length!==32)return null;const r=Pf(e,t),n=Of().xOnlyPointAddTweak(e,r);return!n||n.xOnlyPubkey===null?null:{parity:n.parity,x:new Uint8Array(n.xOnlyPubkey)}}function Pr(e,t){return _r("TapBranch",jt([e,t]))}function If(e){const t=Tr(e.length),r=fe(t);return Sn(e.length,r),jt([r,e])}const On=Y,An=1,Tf=80;class we{static NAME=ot.P2TR;#o;#a;#n;#i;#t;#e;#r;#s;#h;#u;#f;#c;#w;#y;#g;#l;#d;#p;#m;#E;#v;#O=!1;#b=!1;#P=!1;#A=!1;#I=!1;#T=!1;#U=!1;#B=!1;#R=!1;#k;#x=!1;#_;#S=!1;#N;#L=!1;constructor(t,r){this.#o=t.network??Ut,this.#a={validate:r?.validate??!0,allowIncomplete:r?.allowIncomplete??!1},this.#n=t.address,this.#i=t.pubkey,this.#t=t.internalPubkey,this.#e=t.hash,this.#r=t.scriptTree,this.#s=t.signature,this.#h=t.output,this.#u=t.witness,this.#f=t.redeem,this.#c=t.redeemVersion,this.#a.validate&&this.#W()}get name(){return ot.P2TR}get network(){return this.#o}get address(){return this.#O||(this.#w=this.#V(),this.#O=!0),this.#w}get pubkey(){return this.#b||(this.#y=this.#F(),this.#b=!0),this.#y}get internalPubkey(){return this.#P||(this.#g=this.#M(),this.#P=!0),this.#g}get hash(){return this.#A||(this.#l=this.#$(),this.#A=!0),this.#l}get signature(){return this.#I||(this.#d=this.#K(),this.#I=!0),this.#d}get output(){return this.#T||(this.#p=this.#j(),this.#T=!0),this.#p}get redeem(){return this.#U||(this.#m=this.#G(),this.#U=!0),this.#m}get redeemVersion(){return this.#B||(this.#E=this.#q(),this.#B=!0),this.#E??Or}get witness(){return this.#R||(this.#v=this.#Y(),this.#R=!0),this.#v}static fromInternalPubkey(t,r,n){return new we({internalPubkey:t,scriptTree:r,network:n})}static fromAddress(t,r){return new we({address:t,network:r})}static fromOutput(t,r){return new we({output:t,network:r})}static fromSignature(t,r,n){return new we({signature:t,internalPubkey:r,network:n})}toPayment(){return{name:this.name,network:this.network,address:this.address,pubkey:this.pubkey,internalPubkey:this.internalPubkey,hash:this.hash,scriptTree:this.#r,signature:this.signature,output:this.output,redeem:this.redeem,redeemVersion:this.redeemVersion,witness:this.witness}}#H(){if(!this.#x){if(this.#n){const t=kn(this.#n);t&&(this.#k={version:t.version,prefix:t.prefix,data:t.data})}this.#x=!0}return this.#k}#C(){if(!this.#S){if(this.#u&&this.#u.length>0){const t=this.#u[this.#u.length-1];this.#u.length>=2&&t&&t[0]===Tf?this.#_=this.#u.slice(0,-1):this.#_=this.#u.slice()}this.#S=!0}return this.#_}#D(){return this.#L||(this.#r?this.#N=Ar(this.#r):this.#e&&(this.#N={hash:this.#e}),this.#L=!0),this.#N}#V(){if(this.#n)return this.#n;const t=this.pubkey;if(!t)return;const r=ut.bech32m.toWords(t);return r.unshift(An),ut.bech32m.encode(this.#o.bech32,r)}#F(){if(this.#i)return this.#i;if(this.#h)return this.#h.subarray(2);if(this.#n)return this.#H()?.data;const t=this.internalPubkey;if(t){const r=Be(t,this.hash);if(r)return r.x}}#M(){if(this.#t)return this.#t;const t=this.#C();if(t&&t.length>1){const r=t[t.length-1];if(r)return r.subarray(1,33)}}#$(){const t=this.#D();if(t)return t.hash;const r=this.#C();if(r&&r.length>1){const n=r[r.length-1],o=n[0]&ke,h=r[r.length-2],u=pe({output:h,version:o});return vn(n,u)}}#K(){if(this.#s)return this.#s;const t=this.#C();if(t&&t.length===1)return t[0]}#j(){if(this.#h)return this.#h;const t=this.pubkey;if(t)return dt([On.OP_1,t])}#G(){if(this.#f)return this.#f;const t=this.#C();if(!t||t.length<2)return;const r=t[t.length-1];return{output:t[t.length-2],witness:t.slice(0,-2),redeemVersion:r[0]&ke}}#q(){return this.#c!==void 0?this.#c:this.#f&&this.#f.redeemVersion!==void 0&&this.#f.redeemVersion!==null?this.#f.redeemVersion:Or}#Y(){if(this.#u)return this.#u;const t=this.#D();if(t&&this.#f?.output&&this.#t){const r=pe({output:this.#f.output,version:this.redeemVersion}),n=$e(t,r);if(!n)return;const o=Be(this.#t,t.hash);if(!o)return;const h=this.redeemVersion??192,u=jt([new Uint8Array([h|o.parity]),this.#t,...n]);return[this.#f.output,u]}if(this.#s)return[this.#s]}#W(){let t=new Uint8Array(0);if(this.#n){const o=this.#H();if(!o)throw new TypeError("Invalid address");if(this.#o&&this.#o.bech32!==o.prefix)throw new TypeError("Invalid prefix or Network mismatch");if(o.version!==An)throw new TypeError("Invalid address version");if(o.data.length!==32)throw new TypeError("Invalid address data");t=o.data}if(this.#i){if(t.length>0&&!$(t,this.#i))throw new TypeError("Pubkey mismatch");t=this.#i}if(this.#h){if(this.#h.length!==34||this.#h[0]!==On.OP_1||this.#h[1]!==32)throw new TypeError("Output is invalid");if(t.length>0&&!$(t,this.#h.subarray(2)))throw new TypeError("Pubkey mismatch");t=this.#h.subarray(2)}if(this.#t){const o=Be(this.#t,this.hash);if(!o)throw new TypeError("Invalid internal pubkey");if(t.length>0&&!$(t,o.x))throw new TypeError("Pubkey mismatch");t=o.x}const r=this.#D();if(this.#e&&r&&!$(this.#e,r.hash))throw new TypeError("Hash mismatch");if(this.#f?.output&&r){const o=pe({output:this.#f.output,version:this.redeemVersion});if(!$e(r,o))throw new TypeError("Redeem script not in tree")}const n=this.#C();if(this.#f&&this.redeem){if(this.#f.redeemVersion&&this.#f.redeemVersion!==this.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch");if(this.#f.output){const o=ht(this.#f.output);if(!o||o.length===0)throw new TypeError("Redeem.output is invalid");if(this.redeem.output&&!$(this.#f.output,this.redeem.output))throw new TypeError("Redeem.output and witness mismatch")}if(this.#f.witness&&this.redeem.witness&&!ie(this.#f.witness,this.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}if(n&&n.length>0)if(n.length===1){const o=n[0];if(this.#s&&!$(this.#s,o))throw new TypeError("Signature mismatch")}else{const o=n[n.length-1];if(o.length<33)throw new TypeError(`The control-block length is too small. Got ${o.length}, expected min 33.`);if((o.length-33)%32!==0)throw new TypeError(`The control-block length of ${o.length} is incorrect!`);const h=(o.length-33)/32;if(h>128)throw new TypeError(`The script path is too long. Got ${h}, expected max 128.`);const u=o.subarray(1,33);if(this.#t&&!$(this.#t,u))throw new TypeError("Internal pubkey mismatch");if(!Ws(u))throw new TypeError("Invalid internalPubkey for p2tr witness");const c=o[0],p=c&ke,d=n[n.length-2],a=pe({output:d,version:p}),y=vn(o,a),m=Be(u,y);if(!m)throw new TypeError("Invalid outputKey for p2tr witness");if(t.length>0&&!$(t,m.x))throw new TypeError("Pubkey mismatch for p2tr witness");if(m.parity!==(c&1))throw new Error("Incorrect parity")}}}const Pn=Y,Bf=new Uint8Array(0);class ye{static NAME=ot.P2WPKH;#o;#a;#n;#i;#t;#e;#r;#s;#h;#u;#f;#c;#w;#y;#g;#l=!1;#d=!1;#p=!1;#m=!1;#E=!1;#v=!1;#O=!1;#b;#P=!1;constructor(t,r){this.#o=t.network??Ut,this.#a={validate:r?.validate??!0,allowIncomplete:r?.allowIncomplete??!1},this.#n=t.address,this.#i=t.hash,this.#t=t.pubkey,this.#e=t.signature,this.#r=t.output,this.#s=t.witness,this.#a.validate&&this.#_()}get name(){return ot.P2WPKH}get network(){return this.#o}get address(){return this.#l||(this.#h=this.#I(),this.#l=!0),this.#h}get hash(){return this.#d||(this.#u=this.#T(),this.#d=!0),this.#u}get pubkey(){return this.#p||(this.#f=this.#U(),this.#p=!0),this.#f}get signature(){return this.#m||(this.#c=this.#B(),this.#m=!0),this.#c}get output(){return this.#E||(this.#w=this.#R(),this.#E=!0),this.#w}get input(){return this.#v||(this.#y=this.#k(),this.#v=!0),this.#y}get witness(){return this.#O||(this.#g=this.#x(),this.#O=!0),this.#g}static fromPubkey(t,r){return new ye({pubkey:t,network:r})}static fromAddress(t,r){return new ye({address:t,network:r})}static fromHash(t,r){return new ye({hash:t,network:r})}static fromOutput(t,r){return new ye({output:t,network:r})}toPayment(){return{name:this.name,network:this.network,address:this.address,hash:this.hash,pubkey:this.pubkey,signature:this.signature,output:this.output,input:this.input,witness:this.witness}}#A(){if(!this.#P){if(this.#n){const t=ut.bech32.decode(this.#n),r=t.words.shift(),n=ut.bech32.fromWords(t.words);this.#b={version:r??0,prefix:t.prefix,data:new Uint8Array(n)}}this.#P=!0}return this.#b}#I(){if(this.#n)return this.#n;const t=this.hash;if(!t)return;const r=ut.bech32.toWords(t);return r.unshift(0),ut.bech32.encode(this.#o.bech32,r)}#T(){if(this.#i)return this.#i;if(this.#r)return this.#r.subarray(2,22);if(this.#n)return this.#A()?.data;const t=this.#t??this.pubkey;if(t)return At(t)}#U(){if(this.#t)return this.#t;if(this.#s&&this.#s.length>=2)return this.#s[1]}#B(){if(this.#e)return this.#e;if(this.#s&&this.#s.length>=1)return this.#s[0]}#R(){if(this.#r)return this.#r;const t=this.hash;if(t)return dt([Pn.OP_0,t])}#k(){if(this.witness)return Bf}#x(){if(this.#s)return this.#s;if(!(!this.#t||!this.#e))return[this.#e,this.#t]}#_(){let t=new Uint8Array(0);if(this.#n){const r=this.#A();if(!r)throw new TypeError("Invalid address");if(this.#o&&this.#o.bech32!==r.prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r.version!==0)throw new TypeError("Invalid address version");if(r.data.length!==20)throw new TypeError("Invalid address data");t=r.data}if(this.#i){if(t.length>0&&!$(t,this.#i))throw new TypeError("Hash mismatch");t=this.#i}if(this.#r){if(this.#r.length!==22||this.#r[0]!==Pn.OP_0||this.#r[1]!==20)throw new TypeError("Output is invalid");if(t.length>0&&!$(t,this.#r.subarray(2)))throw new TypeError("Hash mismatch");t=this.#r.subarray(2)}if(this.#t){const r=At(this.#t);if(t.length>0&&!$(t,r))throw new TypeError("Hash mismatch");if(t=r,!ne(this.#t)||this.#t.length!==33)throw new TypeError("Invalid pubkey for p2wpkh")}if(this.#s){if(this.#s.length!==2)throw new TypeError("Witness is invalid");const r=this.#s[0],n=this.#s[1];if(!qe(r))throw new TypeError("Witness has invalid signature");if(!ne(n)||n.length!==33)throw new TypeError("Witness has invalid pubkey");if(this.#e&&!$(this.#e,r))throw new TypeError("Signature mismatch");if(this.#t&&!$(this.#t,n))throw new TypeError("Pubkey mismatch");const o=At(n);if(t.length>0&&!$(t,o))throw new TypeError("Hash mismatch")}}}const In=Y,fr=new Uint8Array(0);function Ue(e){return!!(e instanceof Uint8Array&&e.length===65&&e[0]===4&&ne(e))}class ge{static NAME=ot.P2WSH;#o;#a;#n;#i;#t;#e;#r;#s;#h;#u;#f;#c;#w;#y=!1;#g=!1;#l=!1;#d=!1;#p=!1;#m=!1;#E;#v=!1;#O;#b=!1;constructor(t,r){let n=t.network;n||(n=t.redeem&&t.redeem.network||Ut),this.#o=n,this.#a={validate:r?.validate??!0,allowIncomplete:r?.allowIncomplete??!1},this.#n=t.address,this.#i=t.hash,this.#t=t.output,this.#e=t.redeem,this.#r=t.witness,this.#a.validate&&this.#x()}get name(){const t=this.redeem;return t!==void 0&&t.name!==void 0?`p2wsh-${t.name}`:ot.P2WSH}get network(){return this.#o}get address(){return this.#y||(this.#s=this.#I(),this.#y=!0),this.#s}get hash(){return this.#g||(this.#h=this.#T(),this.#g=!0),this.#h}get output(){return this.#l||(this.#u=this.#U(),this.#l=!0),this.#u}get input(){return this.#d||(this.#f=this.#B(),this.#d=!0),this.#f}get redeem(){return this.#p||(this.#c=this.#R(),this.#p=!0),this.#c}get witness(){return this.#m||(this.#w=this.#k(),this.#m=!0),this.#w}static fromRedeem(t,r){return new ge({redeem:t,network:r})}static fromAddress(t,r){return new ge({address:t,network:r})}static fromHash(t,r){return new ge({hash:t,network:r})}static fromOutput(t,r){return new ge({output:t,network:r})}toPayment(){const t=this.witness,r=this.redeem;return{name:this.name,network:this.network,address:this.address,hash:this.hash,output:this.output,input:this.input,redeem:r,witness:t}}#P(){if(!this.#v){if(this.#n){const t=ut.bech32.decode(this.#n),r=t.words.shift(),n=ut.bech32.fromWords(t.words);this.#E={version:r??0,prefix:t.prefix,data:new Uint8Array(n)}}this.#v=!0}return this.#E}#A(){return this.#b||(this.#e?.input&&(this.#O=ht(this.#e.input)??void 0),this.#b=!0),this.#O}#I(){if(this.#n)return this.#n;const t=this.hash;if(!t)return;const r=ut.bech32.toWords(t);return r.unshift(0),ut.bech32.encode(this.#o.bech32,r)}#T(){if(this.#i)return this.#i;if(this.#t)return this.#t.subarray(2);if(this.#n)return this.#P()?.data;const t=this.redeem;if(t&&t.output)return wr(t.output)}#U(){if(this.#t)return this.#t;const t=this.hash;if(t)return dt([In.OP_0,t])}#B(){if(this.witness)return fr}#R(){if(this.#e)return this.#e;if(this.#r&&this.#r.length>0)return{output:this.#r[this.#r.length-1],input:fr,witness:this.#r.slice(0,-1)}}#k(){if(this.#r)return this.#r;const t=this.#e;if(t){if(t.input&&t.input.length>0&&t.output&&t.output.length>0){const r=this.#A();if(r){const n=eo(r);return this.#c=Object.assign({witness:n},t,{input:fr}),this.#p=!0,[].concat(n,t.output)}}return!t.output||!t.witness?void 0:[].concat(t.witness,t.output)}}#x(){let t=new Uint8Array(0);if(this.#n){const r=this.#P();if(!r)throw new TypeError("Invalid address");if(r.prefix!==this.#o.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(r.version!==0)throw new TypeError("Invalid address version");if(r.data.length!==32)throw new TypeError("Invalid address data");t=r.data}if(this.#i){if(t.length>0&&!$(t,this.#i))throw new TypeError("Hash mismatch");t=this.#i}if(this.#t){if(this.#t.length!==34||this.#t[0]!==In.OP_0||this.#t[1]!==32)throw new TypeError("Output is invalid");const r=this.#t.subarray(2);if(t.length>0&&!$(t,r))throw new TypeError("Hash mismatch");t=r}if(this.#e){if(this.#e.network&&this.#e.network!==this.#o)throw new TypeError("Network mismatch");if(this.#e.input&&this.#e.input.length>0&&this.#e.witness&&this.#e.witness.length>0)throw new TypeError("Ambiguous witness source");if(this.#e.output){const n=ht(this.#e.output);if(!n||n.length<1)throw new TypeError("Redeem.output is invalid");if(this.#e.output.byteLength>3600)throw new TypeError("Redeem.output unspendable if larger than 3600 bytes");if(Wn(n)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const o=wr(this.#e.output);if(t.length>0&&!$(t,o))throw new TypeError("Hash mismatch");t=o}const r=this.#A();if(this.#e.input&&r&&!xr(r))throw new TypeError("Non push-only scriptSig");if(this.#r&&this.#e.witness&&!ie(this.#r,this.#e.witness))throw new TypeError("Witness and redeem.witness mismatch");if(this.#e.input&&r?.some(Ue)||this.#e.output&&(ht(this.#e.output)||[]).some(Ue))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(this.#r&&this.#r.length>0){const r=this.#r[this.#r.length-1];if(this.#e&&this.#e.output&&!$(this.#e.output,r))throw new TypeError("Witness and redeem.output mismatch");if(this.#r.some(Ue)||(ht(r)||[]).some(Ue))throw new TypeError("Witness contains uncompressed pubkey")}}}const Tn=Y;class Se{static NAME=ot.P2PK;#o;#a;#n;#i;#t;#e;#r;#s;#h;#u;#f;#c=!1;#w=!1;#y=!1;#g=!1;#l=!1;constructor(t,r){this.#o=t.network??Ut,this.#a={validate:r?.validate??!0,allowIncomplete:r?.allowIncomplete??!1},this.#n=t.pubkey,this.#i=t.signature,this.#t=t.output,this.#e=t.input,this.#a.validate&&this.#O()}get name(){return ot.P2PK}get network(){return this.#o}get pubkey(){return this.#c||(this.#r=this.#d(),this.#c=!0),this.#r}get signature(){return this.#w||(this.#s=this.#p(),this.#w=!0),this.#s}get output(){return this.#y||(this.#h=this.#m(),this.#y=!0),this.#h}get input(){return this.#g||(this.#u=this.#E(),this.#g=!0),this.#u}get witness(){return this.#l||(this.#f=this.#v(),this.#l=!0),this.#f}static fromPubkey(t,r){return new Se({pubkey:t,network:r})}static fromOutput(t,r){return new Se({output:t,network:r})}static fromSignature(t,r,n){return new Se({signature:t,pubkey:r,network:n})}toPayment(){return{name:this.name,network:this.network,pubkey:this.pubkey,signature:this.signature,output:this.output,input:this.input,witness:this.witness}}#d(){if(this.#n)return this.#n;if(this.#t)return this.#t.subarray(1,-1)}#p(){if(this.#i)return this.#i;if(this.#e){const t=ht(this.#e);if(t&&t.length>0)return t[0]}}#m(){if(this.#t)return this.#t;const t=this.#n;if(t)return dt([t,Tn.OP_CHECKSIG])}#E(){if(this.#e)return this.#e;const t=this.#i;if(t)return dt([t])}#v(){if(this.input)return[]}#O(){if(this.#t){if(this.#t[this.#t.length-1]!==Tn.OP_CHECKSIG)throw new TypeError("Output is invalid");const t=this.pubkey;if(!ne(t))throw new TypeError("Output pubkey is invalid");if(this.#n&&t&&!$(this.#n,t))throw new TypeError("Pubkey mismatch")}if(this.#i){const t=this.input;if(this.#e&&t&&!$(this.#e,t))throw new TypeError("Signature mismatch")}if(this.#e){const t=ht(this.#e);if(!t||t.length!==1)throw new TypeError("Input is invalid");const r=this.signature;if(!r||!qe(r))throw new TypeError("Input has invalid signature")}}}const ee=Y,Re=ee.OP_RESERVED;let Df=class Ne{static NAME=ot.P2MS;#o;#a;#n;#i;#t;#e;#r;#s;#h;#u;#f;#c;#w;#y;#g;#l=!1;#d=!1;#p=!1;#m=!1;#E=!1;#v=!1;#O=!1;#b;#P=!1;constructor(t,r){this.#o=t.network??Ut,this.#a={validate:r?.validate??!0,allowIncomplete:r?.allowIncomplete??!1},this.#n=t.m,this.#i=t.n,this.#t=t.pubkeys,this.#e=t.signatures,this.#r=t.output,this.#s=t.input,this.#a.validate&&this.#S()}get name(){const t=this.m,r=this.n;return t!==void 0&&r!==void 0?`p2ms(${t} of ${r})`:ot.P2MS}get network(){return this.#o}get m(){return this.#l||(this.#h=this.#I(),this.#l=!0),this.#h}get n(){return this.#d||(this.#u=this.#T(),this.#d=!0),this.#u}get pubkeys(){return this.#p||(this.#f=this.#U(),this.#p=!0),this.#f}get signatures(){return this.#m||(this.#c=this.#B(),this.#m=!0),this.#c}get output(){return this.#E||(this.#w=this.#R(),this.#E=!0),this.#w}get input(){return this.#v||(this.#y=this.#k(),this.#v=!0),this.#y}get witness(){return this.#O||(this.#g=this.#x(),this.#O=!0),this.#g}static fromPubkeys(t,r,n){return new Ne({m:t,pubkeys:r,network:n})}static fromOutput(t,r){return new Ne({output:t,network:r})}static fromSignatures(t,r,n,o){return new Ne({signatures:t,m:r,pubkeys:n,network:o})}toPayment(){return{name:this.name,network:this.network,m:this.m,n:this.n,pubkeys:this.pubkeys,signatures:this.signatures,output:this.output,input:this.input,witness:this.witness}}#A(t){this.#P||(this.#P=!0,this.#b=ht(t)??[],this.#h=this.#b[0]-Re,this.#u=this.#b[this.#b.length-2]-Re,this.#f=this.#b.slice(1,-2),this.#l=!0,this.#d=!0,this.#p=!0)}#I(){if(this.#n!==void 0)return this.#n;const t=this.#r??this.output;if(t)return this.#A(t),this.#h}#T(){if(this.#i!==void 0)return this.#i;if(this.#t)return this.#t.length;if(this.#r)return this.#A(this.#r),this.#u}#U(){if(this.#t)return this.#t;if(this.#r)return this.#A(this.#r),this.#f}#B(){if(this.#e)return this.#e;if(this.#s)return ht(this.#s)?.slice(1)}#R(){if(this.#r)return this.#r;const t=this.#n,r=this.n,n=this.#t;if(!(t===void 0||r===void 0||!n))return dt([].concat(Re+t,n,Re+r,ee.OP_CHECKMULTISIG))}#k(){if(this.#s)return this.#s;if(this.#e)return dt([ee.OP_0].concat(this.#e))}#x(){if(this.input)return[]}#_(t){return qe(t)||this.#a.allowIncomplete&&t===ee.OP_0}#S(){if(this.#r){this.#A(this.#r);const t=this.#b;if(!t)throw new TypeError("Output is invalid");if(typeof t[0]!="number")throw new TypeError("Output is invalid");if(typeof t[t.length-2]!="number")throw new TypeError("Output is invalid");if(t[t.length-1]!==ee.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");const r=this.#h,n=this.#u,o=this.#f;if(r===void 0||n===void 0||!o)throw new TypeError("Output is invalid");if(r<=0||n>16||r>n||n!==t.length-3)throw new TypeError("Output is invalid");if(!o.every(h=>ne(h)))throw new TypeError("Output is invalid");if(this.#n!==void 0&&this.#n!==r)throw new TypeError("m mismatch");if(this.#i!==void 0&&this.#i!==n)throw new TypeError("n mismatch");if(this.#t&&!ie(this.#t,o))throw new TypeError("Pubkeys mismatch")}if(this.#t){if(this.#i!==void 0&&this.#i!==this.#t.length)throw new TypeError("Pubkey count mismatch");if(this.#u=this.#t.length,this.#d=!0,this.#h!==void 0&&this.#u<this.#h)throw new TypeError("Pubkey count cannot be less than m")}if(this.#e){if(this.#h!==void 0&&this.#e.length<this.#h)throw new TypeError("Not enough signatures provided");if(this.#h!==void 0&&this.#e.length>this.#h)throw new TypeError("Too many signatures provided")}if(this.#s){if(this.#s[0]!==ee.OP_0)throw new TypeError("Input is invalid");const t=this.signatures;if(!t||t.length===0||!t.every(r=>this.#_(r)))throw new TypeError("Input has invalid signature(s)");if(this.#e&&!ie(this.#e,t))throw new TypeError("Signature mismatch");if(this.#n!==void 0&&this.#e&&this.#n!==this.#e.length)throw new TypeError("Signature count mismatch")}}};oe("0000000000000000000000000000000000000000000000000000000000000000");zs(oe("0000000000000000000000000000000000000000000000000000000000000001"));const Bn=Y;class Ir{static NAME=ot.Embed;#o;#a;#n;#i;#t;#e;#r=!1;#s=!1;constructor(t,r){this.#o=t.network??Ut,this.#a={validate:r?.validate??!0,allowIncomplete:r?.allowIncomplete??!1},this.#n=t.data,this.#i=t.output,this.#a.validate&&this.#f()}get name(){return ot.Embed}get network(){return this.#o}get data(){return this.#r||(this.#t=this.#h(),this.#r=!0),this.#t??[]}get output(){return this.#s||(this.#e=this.#u(),this.#s=!0),this.#e}static fromData(t,r){return new Ir({data:t,network:r})}static fromOutput(t,r){return new Ir({output:t,network:r})}toPayment(){return{name:this.name,network:this.network,data:this.data,output:this.output}}#h(){if(this.#n)return this.#n;if(this.#i)return ht(this.#i)?.slice(1)}#u(){if(this.#i)return this.#i;if(this.#n)return dt([Bn.OP_RETURN].concat(this.#n))}#f(){if(this.#i){const t=ht(this.#i);if(!t)throw new TypeError("Output is invalid");if(t[0]!==Bn.OP_RETURN)throw new TypeError("Output is invalid");if(!t.slice(1).every(r=>r instanceof Uint8Array))throw new TypeError("Output is invalid");if(this.#n&&!ie(this.#n,this.data))throw new TypeError("Data mismatch")}}}oe("6a24aa21a9ed");var Un;(function(e){e[e.UNSIGNED_TX=0]="UNSIGNED_TX",e[e.GLOBAL_XPUB=1]="GLOBAL_XPUB"})(Un||(Un={}));var _t;(function(e){e[e.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",e[e.WITNESS_UTXO=1]="WITNESS_UTXO",e[e.PARTIAL_SIG=2]="PARTIAL_SIG",e[e.SIGHASH_TYPE=3]="SIGHASH_TYPE",e[e.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=6]="BIP32_DERIVATION",e[e.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",e[e.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",e[e.POR_COMMITMENT=9]="POR_COMMITMENT",e[e.TAP_KEY_SIG=19]="TAP_KEY_SIG",e[e.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",e[e.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",e[e.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",e[e.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT"})(_t||(_t={}));var $t;(function(e){e[e.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=2]="BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",e[e.TAP_TREE=6]="TAP_TREE",e[e.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION"})($t||($t={}));const Ke="0123456789abcdefABCDEF",je=Ke.split("").map(e=>e.codePointAt(0)),Rn=Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),n=Ke.indexOf(r);return n<0?void 0:n<16?n:n-6});new TextEncoder;const Uf=new TextDecoder;function Ni(e){const t=e.reduce((o,h)=>o+h.length,0),r=new Uint8Array(t);let n=0;for(const o of e)r.set(o,n),n+=o.length;return r}function Xt(e){const t=e||new Uint8Array;return t.length>512?kf(t):Rf(t)}function Rf(e){let t="";for(let r=0;r<e.length;++r)t+=Ke[Rn[je[e[r]>>4]]],t+=Ke[Rn[je[e[r]&15]]];return t}function kf(e){const t=new Uint8Array(e.length*2);for(let r=0;r<e.length;++r)t[r*2]=je[e[r]>>4],t[r*2+1]=je[e[r]&15];return Uf.decode(t)}function xf(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;++n)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return e.length===t.length?0:e.length>t.length?1:-1}function _f(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${r}`);return n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255),t+4}function Sf(e,t,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+3]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t]>>>0,n}else{let n=0;return n=(n<<8)+e[t]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+3]>>>0,n}}const Nf=e=>[...Array(e).keys()],Lf=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&e[0]===4;function $r(e,t=Lf){function r(c){if(c.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+Xt(c.key));const p=c.key.slice(1);if(!t(p))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+Xt(c.key));if(c.value.length/4%1!==0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");const d={masterFingerprint:c.value.slice(0,4),pubkey:p,path:"m"};for(const a of Nf(c.value.length/4-1)){const y=Sf(c.value,a*4+4,"LE"),m=!!(y&2147483648),b=y&2147483647;d.path+="/"+b.toString(10)+(m?"'":"")}return d}function n(c){const p=Uint8Array.from([e]),d=Ni([p,c.pubkey]),a=c.path.split("/"),y=new Uint8Array(a.length*4);y.set(c.masterFingerprint,0);let m=4;return a.slice(1).forEach(b=>{const v=b.slice(-1)==="'";let E=2147483647&parseInt(v?b.slice(0,-1):b,10);v&&(E+=2147483648),_f(y,m,E,"LE"),m+=4}),{key:d,value:y}}const o="{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; }";function h(c){return c.pubkey instanceof Uint8Array&&c.masterFingerprint instanceof Uint8Array&&typeof c.path=="string"&&t(c.pubkey)&&c.masterFingerprint.length===4}function u(c,p,d){const a=Xt(p.pubkey);return d.has(a)?!1:(d.add(a),c.filter(y=>xf(y.pubkey,p.pubkey)===0).length===0)}return{decode:r,encode:n,check:h,expected:o,canAddToArray:u}}function Li(e){return t;function t(r){let n;if(e.includes(r.key[0])&&(n=r.key.slice(1),!(n.length===33||n.length===65)||![2,3,4].includes(n[0])))throw new Error("Format Error: invalid pubkey in key 0x"+Xt(r.key));return n}}function Ci(e){function t(u){if(u.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+Xt(u.key));return u.value}function r(u){return{key:Uint8Array.from([e]),value:u}}const n="Uint8Array";function o(u){return u instanceof Uint8Array}function h(u,c){return!!u&&!!c&&u.redeemScript===void 0}return{decode:t,encode:r,check:o,expected:n,canAdd:h}}const Cf=e=>e.length===32;function Hi(e){const t=$r(e,Cf);function r(u){const{numberValue:c,bytes:p}=ls(u.value),d=t.decode({key:u.key,value:u.value.slice(p+Number(c)*32)}),a=new Array(Number(c));for(let y=0,m=p;y<c;y++,m+=32)a[y]=u.value.slice(m,m+32);return{...d,leafHashes:a}}function n(u){const c=t.encode(u),p=Tr(u.leafHashes.length),d=new Uint8Array(p);Sn(u.leafHashes.length,d);const a=Ni([d,...u.leafHashes,c.value]);return{...c,value:a}}const o="{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; leafHashes: Uint8Array[]; }";function h(u){return Array.isArray(u.leafHashes)&&u.leafHashes.every(c=>c instanceof Uint8Array&&c.length===32)&&t.check(u)}return{decode:r,encode:n,check:h,expected:o,canAddToArray:t.canAddToArray}}function Di(e){function t(u){if(u.key[0]!==e||u.key.length!==1)throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+Xt(u.key));if(u.value.length!==32)throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return u.value}function r(u){return{key:Uint8Array.from([e]),value:u}}const n="Uint8Array";function o(u){return u instanceof Uint8Array&&u.length===32}function h(u,c){return!!u&&!!c&&u.tapInternalKey===void 0}return{decode:t,encode:r,check:o,expected:n,canAdd:h}}function Vi(e){function t(u){if(u.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+Xt(u.key));return u.value}function r(u){return{key:Uint8Array.from([e]),value:u}}const n="Uint8Array";function o(u){return u instanceof Uint8Array}function h(u,c){return!!u&&!!c&&u.witnessScript===void 0}return{decode:t,encode:r,check:o,expected:n,canAdd:h}}$r(_t.BIP32_DERIVATION),Ci(_t.REDEEM_SCRIPT),Vi(_t.WITNESS_SCRIPT),Li([_t.PARTIAL_SIG,_t.BIP32_DERIVATION]),Hi(_t.TAP_BIP32_DERIVATION),Di(_t.TAP_INTERNAL_KEY);$r($t.BIP32_DERIVATION),Ci($t.REDEEM_SCRIPT),Vi($t.WITNESS_SCRIPT),Li([$t.BIP32_DERIVATION]),Hi($t.TAP_BIP32_DERIVATION),Di($t.TAP_INTERNAL_KEY);export{Hf as e};
